{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Button from \"antd/lib/button\";\nimport _Tabs from \"antd/lib/tabs\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useSelector } from 'react-redux';\nimport { useEffect } from 'react';\nimport Repo from '../components/Repo';\nimport config from '../config';\nimport LRU from 'lru-cache';\nimport Router, { useRouter } from 'next/router';\nimport { cacheArray } from '../lib/repo-basic-cache';\nvar OAUTH_URL = config.OAUTH_URL;\nvar TabPane = _Tabs.TabPane;\nvar cache = new LRU({\n  maxAge: 1000 * 60 * 30 //30min\n\n});\nvar isServer = false;\nexport default function Index(_ref) {\n  var _ref$userRepos = _ref.userRepos,\n      userRepos = _ref$userRepos === void 0 ? [] : _ref$userRepos,\n      _ref$userStarredRepos = _ref.userStarredRepos,\n      userStarredRepos = _ref$userStarredRepos === void 0 ? [] : _ref$userStarredRepos;\n  var user = useSelector(function (state) {\n    return state.user;\n  });\n  var router = useRouter();\n  var activeTabKey = router.query.key || 'repos';\n\n  var handleTabChange = function handleTabChange(activeTabKey) {\n    Router.push(\"/?key=\".concat(activeTabKey));\n  }; //在Index页面不频繁请求repo信息\n\n\n  useEffect(function () {\n    if (!isServer) {\n      userRepos && cache.set('userRepos', userRepos);\n      userStarredRepos && cache.set('userStarredRepos', userStarredRepos);\n    }\n  }, [userRepos, userStarredRepos]); //跳转到/search页面不用重新请求repo信息\n\n  useEffect(function () {\n    if (!isServer) {\n      cacheArray(userRepos);\n      cacheArray(userStarredRepos);\n    }\n  });\n\n  var BeforeLogin = function BeforeLogin() {\n    return __jsx(React.Fragment, null, __jsx(\"div\", {\n      className: \"jsx-449660228\" + \" \" + \"root\"\n    }, __jsx(_Button, {\n      href: OAUTH_URL\n    }, \"Click to log into your Github account\")), __jsx(_JSXStyle, {\n      id: \"449660228\"\n    }, \".root.jsx-449660228{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6XFznvJbnqItcXOmhueebrlxcbmV4dOmhueebrlxcbmV4dC1naXRodWJcXHBhZ2VzXFxpbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFnRGUsQUFHbUIsMEVBQ1UsbUdBQ0osNkZBQ3BCIiwiZmlsZSI6IkQ6XFznvJbnqItcXOmhueebrlxcbmV4dOmhueebrlxcbmV4dC1naXRodWJcXHBhZ2VzXFxpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVNlbGVjdG9yIH0gZnJvbSAncmVhY3QtcmVkdXgnXHJcbmltcG9ydCB7IEJ1dHRvbiwgVGFicyB9IGZyb20gJ2FudGQnXHJcbmltcG9ydCB7IHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0J1xyXG5pbXBvcnQgUmVwbyBmcm9tICcuLi9jb21wb25lbnRzL1JlcG8nXHJcbmltcG9ydCBjb25maWcgZnJvbSAnLi4vY29uZmlnJ1xyXG5pbXBvcnQgTFJVIGZyb20gJ2xydS1jYWNoZSdcclxuaW1wb3J0ICBSb3V0ZXIsIHsgdXNlUm91dGVyIH0gZnJvbSAnbmV4dC9yb3V0ZXInXHJcbmltcG9ydCB7IGNhY2hlQXJyYXkgfSBmcm9tICcuLi9saWIvcmVwby1iYXNpYy1jYWNoZSdcclxuXHJcbmNvbnN0IHsgT0FVVEhfVVJMIH0gPSBjb25maWc7XHJcbmNvbnN0IHsgVGFiUGFuZSB9ID0gVGFicztcclxuY29uc3QgY2FjaGUgPSBuZXcgTFJVKHtcclxuICAgIG1heEFnZTogMTAwMCAqIDYwICogMzAgLy8zMG1pblxyXG59KVxyXG5jb25zdCBpc1NlcnZlciA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnXHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBJbmRleCh7IHVzZXJSZXBvcyA9IFtdLCB1c2VyU3RhcnJlZFJlcG9zID0gW10gfSkge1xyXG4gICAgY29uc3QgdXNlciA9IHVzZVNlbGVjdG9yKHN0YXRlID0+IHN0YXRlLnVzZXIpO1xyXG4gICAgY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCk7XHJcbiAgICBjb25zdCBhY3RpdmVUYWJLZXkgPSByb3V0ZXIucXVlcnkua2V5IHx8ICdyZXBvcyc7XHJcblxyXG4gICAgY29uc3QgaGFuZGxlVGFiQ2hhbmdlID0gKGFjdGl2ZVRhYktleSkgPT4ge1xyXG4gICAgICAgIFJvdXRlci5wdXNoKGAvP2tleT0ke2FjdGl2ZVRhYktleX1gKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvL+WcqEluZGV46aG16Z2i5LiN6aKR57mB6K+35rGCcmVwb+S/oeaBr1xyXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgICAgICBpZiAoIWlzU2VydmVyKSB7IFxyXG4gICAgICAgICAgICB1c2VyUmVwb3MgJiYgY2FjaGUuc2V0KCd1c2VyUmVwb3MnLCB1c2VyUmVwb3MpXHJcbiAgICAgICAgICAgIHVzZXJTdGFycmVkUmVwb3MgJiYgIGNhY2hlLnNldCgndXNlclN0YXJyZWRSZXBvcycsIHVzZXJTdGFycmVkUmVwb3MpXHJcbiAgICAgICAgfVxyXG4gICAgfSwgW3VzZXJSZXBvcywgdXNlclN0YXJyZWRSZXBvc10pXHJcblxyXG4gICAgLy/ot7PovazliLAvc2VhcmNo6aG16Z2i5LiN55So6YeN5paw6K+35rGCcmVwb+S/oeaBr1xyXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgICAgICBpZiAoIWlzU2VydmVyKSB7XHJcbiAgICAgICAgICAgIGNhY2hlQXJyYXkodXNlclJlcG9zKVxyXG4gICAgICAgICAgICBjYWNoZUFycmF5KHVzZXJTdGFycmVkUmVwb3MpXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuXHJcblx0Y29uc3QgQmVmb3JlTG9naW4gPSAoKSA9PiAoXHJcblx0XHQ8PlxyXG5cdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cInJvb3RcIj5cclxuXHRcdFx0XHQ8QnV0dG9uIGhyZWY9e09BVVRIX1VSTH0+XHJcbiAgICAgICAgICAgICAgICAgICAgQ2xpY2sgdG8gbG9nIGludG8geW91ciBHaXRodWIgYWNjb3VudFxyXG4gICAgICAgICAgICAgICAgPC9CdXR0b24+XHJcblx0XHRcdDwvZGl2PlxyXG5cdFx0XHQ8c3R5bGUganN4PntgXHJcblx0XHRcdFx0LnJvb3Qge1xyXG5cdFx0XHRcdFx0ZGlzcGxheTogZmxleDtcclxuXHRcdFx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG5cdFx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdGB9PC9zdHlsZT5cclxuXHRcdDwvPlxyXG5cdClcclxuXHRcclxuXHRpZiAoIXVzZXIgfHwgIXVzZXIuaWQpIHtcclxuXHRcdHJldHVybiA8QmVmb3JlTG9naW4gLz5cclxuXHR9XHJcblxyXG5cdHJldHVybiAoXHJcblx0XHQ8PlxyXG5cdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cInJvb3RcIj5cclxuXHRcdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cInVzZXItaW5mb1wiPlxyXG5cdFx0XHRcdFx0PGltZyBzcmM9e3VzZXIuYXZhdGFyX3VybH0gYWx0PVwidXNlciBhdmF0YXJcIiBjbGFzc05hbWU9XCJ1c2VyLWF2YXRhclwiLz5cclxuXHRcdFx0XHRcdDxwIGNsYXNzTmFtZT1cInVzZXItbmFtZVwiPnt1c2VyLmxvZ2lufTwvcD5cclxuXHRcdFx0XHQ8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxUYWJzIFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUtleT17YWN0aXZlVGFiS2V5fSBcclxuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlVGFiQ2hhbmdlfSBcclxuICAgICAgICAgICAgICAgICAgICBhbmltYXRlZD17ZmFsc2V9XHJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZT1cImxhcmdlXCJcclxuICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICA8VGFiUGFuZSBrZXk9XCJyZXBvc1wiIHRhYj1cIlJlcG9zaXRvcmllc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dXNlclJlcG9zLm1hcChyZXBvID0+IDxSZXBvIGtleT17cmVwby5pZH0gcmVwbz17cmVwb30gLz4pfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvVGFiUGFuZT5cclxuICAgICAgICAgICAgICAgICAgICA8VGFiUGFuZSBrZXk9XCJzdGFyc1wiIHRhYj1cIlN0YXJzXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHt1c2VyU3RhcnJlZFJlcG9zLm1hcChyZXBvID0+IDxSZXBvIGtleT17cmVwby5pZH0gcmVwbz17cmVwb30gLz4pfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvVGFiUGFuZT5cclxuICAgICAgICAgICAgICAgIDwvVGFicz5cclxuXHRcdFx0PC9kaXY+XHJcblx0XHRcdDxzdHlsZSBqc3g+e2BcclxuXHRcdFx0XHQucm9vdCB7XHJcblx0XHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xyXG5cdFx0XHRcdFx0YWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XHJcblx0XHRcdFx0XHRwYWRkaW5nOiAyMHB4IDA7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC51c2VyLWluZm8ge1xyXG5cdFx0XHRcdFx0d2lkdGg6IDIwMHB4O1xyXG5cdFx0XHRcdFx0bWFyZ2luLXJpZ2h0OiA0MHB4O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQudXNlci1uYW1lIHtcclxuXHRcdFx0XHRcdGZvbnQtc2l6ZTogMjBweDtcclxuXHRcdFx0XHRcdGZvbnQtd2VpZ2h0OiAzMDA7XHJcblx0XHRcdFx0XHRtYXJnaW4tdG9wOiAxMHB4O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQudXNlci1hdmF0YXIge1xyXG5cdFx0XHRcdFx0d2lkdGg6IDEwMCU7XHJcblx0XHRcdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRgfTwvc3R5bGU+XHJcblx0XHQ8Lz5cclxuXHQpXHJcbn1cclxuXHJcbmNvbnN0IGFwaSA9IHJlcXVpcmUoJy4uL2xpYi9hcGknKVxyXG4vL+iwg+eUqO+8miDmnI3liqHnq6/muLLmn5NpbmRleOaXtiAv5a6i5oi356uv5a+86Iiq5YiwaW5kZXjml7ZcclxuLy/mtY/op4jlmajnjq/looPvvJogYXhpb3MuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAveHh4JylcclxuLy9ub2Rl546v5aKD77yaIGF4aW9zLmdldCgnaHR0cDovL2xvY2FsaG9zdDo4MC94eHgnKVxyXG5JbmRleC5nZXRJbml0aWFsUHJvcHMgPSBhc3luYyAoeyByZXEsIHJlcywgcmVkdXhTdG9yZSB9KSA9PiB7XHJcbiAgICBjb25zdCB1c2VyID0gcmVkdXhTdG9yZS5nZXRTdGF0ZSgpLnVzZXI7XHJcbiAgICBpZiAoIXVzZXIgfHwgIXVzZXIuaWQgKSB7XHJcbiAgICAgICAgcmV0dXJuIHt9ICBcclxuICAgIH1cclxuICAgIGlmICghaXNTZXJ2ZXIpIHsgLy/mnI3liqHnq6/njq/looPkuI3kvb/nlKjnvJPlrZhcclxuICAgICAgICBjb25zdCB1c2VyUmVwb3MgPSBjYWNoZS5nZXQoJ3VzZXJSZXBvcycpO1xyXG4gICAgICAgIGNvbnN0IHVzZXJTdGFycmVkUmVwb3MgPSBjYWNoZS5nZXQoJ3VzZXJTdGFycmVkUmVwb3MnKVxyXG4gICAgICAgIGlmICh1c2VyUmVwb3MgJiYgdXNlclN0YXJyZWRSZXBvcykge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdXNlclJlcG9zLFxyXG4gICAgICAgICAgICAgICAgdXNlclN0YXJyZWRSZXBvcyAgICBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB1c2VyUmVwb3NSZXNwID0gYXdhaXQgYXBpLnJlcXVlc3QoXHJcbiAgICAgICAgeyB1cmw6ICcvdXNlci9yZXBvcycgfSwgXHJcbiAgICAgICAgcmVxLCBcclxuICAgICAgICByZXNcclxuICAgICk7XHJcbiAgICBjb25zdCB1c2VyU3RhcnJlZFJlcG9zUmVzcCA9IGF3YWl0IGFwaS5yZXF1ZXN0KFxyXG4gICAgICAgIHsgdXJsOiAnL3VzZXIvc3RhcnJlZCd9LFxyXG4gICAgICAgIHJlcSxcclxuICAgICAgICByZXNcclxuICAgICk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHVzZXJSZXBvczogdXNlclJlcG9zUmVzcC5kYXRhIHx8IFtdLFxyXG4gICAgICAgIHVzZXJTdGFycmVkUmVwb3M6IHVzZXJTdGFycmVkUmVwb3NSZXNwLmRhdGEgfHwgW11cclxuICAgIH1cclxufVxyXG5cclxuIl19 */\\n/*@ sourceURL=D:\\\\\\\\\\u7F16\\u7A0B\\\\\\\\\\u9879\\u76EE\\\\\\\\next\\u9879\\u76EE\\\\\\\\next-github\\\\\\\\pages\\\\\\\\index.js */\"));\n  };\n\n  if (!user || !user.id) {\n    return __jsx(BeforeLogin, null);\n  }\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"jsx-1042228906\" + \" \" + \"root\"\n  }, __jsx(\"div\", {\n    className: \"jsx-1042228906\" + \" \" + \"user-info\"\n  }, __jsx(\"img\", {\n    src: user.avatar_url,\n    alt: \"user avatar\",\n    className: \"jsx-1042228906\" + \" \" + \"user-avatar\"\n  }), __jsx(\"p\", {\n    className: \"jsx-1042228906\" + \" \" + \"user-name\"\n  }, user.login)), __jsx(_Tabs, {\n    activeKey: activeTabKey,\n    onChange: handleTabChange,\n    animated: false,\n    size: \"large\"\n  }, __jsx(TabPane, {\n    key: \"repos\",\n    tab: \"Repositories\"\n  }, userRepos.map(function (repo) {\n    return __jsx(Repo, {\n      key: repo.id,\n      repo: repo\n    });\n  })), __jsx(TabPane, {\n    key: \"stars\",\n    tab: \"Stars\"\n  }, userStarredRepos.map(function (repo) {\n    return __jsx(Repo, {\n      key: repo.id,\n      repo: repo\n    });\n  })))), __jsx(_JSXStyle, {\n    id: \"1042228906\"\n  }, \".root.jsx-1042228906{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;padding:20px 0;}.user-info.jsx-1042228906{width:200px;margin-right:40px;}.user-name.jsx-1042228906{font-size:20px;font-weight:300;margin-top:10px;}.user-avatar.jsx-1042228906{width:100%;border-radius:4px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6XFznvJbnqItcXOmhueebrlxcbmV4dOmhueebrlxcbmV4dC1naXRodWJcXHBhZ2VzXFxpbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFtRmUsQUFHbUIsQUFLRCxBQUlHLEFBS0osV0FDTyxDQVRBLEdBSUYsY0FNakIsQ0FUQSxDQUlpQixnQkFDakIsMkJBWHdCLDZHQUNSLGVBQ2hCIiwiZmlsZSI6IkQ6XFznvJbnqItcXOmhueebrlxcbmV4dOmhueebrlxcbmV4dC1naXRodWJcXHBhZ2VzXFxpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVNlbGVjdG9yIH0gZnJvbSAncmVhY3QtcmVkdXgnXHJcbmltcG9ydCB7IEJ1dHRvbiwgVGFicyB9IGZyb20gJ2FudGQnXHJcbmltcG9ydCB7IHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0J1xyXG5pbXBvcnQgUmVwbyBmcm9tICcuLi9jb21wb25lbnRzL1JlcG8nXHJcbmltcG9ydCBjb25maWcgZnJvbSAnLi4vY29uZmlnJ1xyXG5pbXBvcnQgTFJVIGZyb20gJ2xydS1jYWNoZSdcclxuaW1wb3J0ICBSb3V0ZXIsIHsgdXNlUm91dGVyIH0gZnJvbSAnbmV4dC9yb3V0ZXInXHJcbmltcG9ydCB7IGNhY2hlQXJyYXkgfSBmcm9tICcuLi9saWIvcmVwby1iYXNpYy1jYWNoZSdcclxuXHJcbmNvbnN0IHsgT0FVVEhfVVJMIH0gPSBjb25maWc7XHJcbmNvbnN0IHsgVGFiUGFuZSB9ID0gVGFicztcclxuY29uc3QgY2FjaGUgPSBuZXcgTFJVKHtcclxuICAgIG1heEFnZTogMTAwMCAqIDYwICogMzAgLy8zMG1pblxyXG59KVxyXG5jb25zdCBpc1NlcnZlciA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnXHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBJbmRleCh7IHVzZXJSZXBvcyA9IFtdLCB1c2VyU3RhcnJlZFJlcG9zID0gW10gfSkge1xyXG4gICAgY29uc3QgdXNlciA9IHVzZVNlbGVjdG9yKHN0YXRlID0+IHN0YXRlLnVzZXIpO1xyXG4gICAgY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCk7XHJcbiAgICBjb25zdCBhY3RpdmVUYWJLZXkgPSByb3V0ZXIucXVlcnkua2V5IHx8ICdyZXBvcyc7XHJcblxyXG4gICAgY29uc3QgaGFuZGxlVGFiQ2hhbmdlID0gKGFjdGl2ZVRhYktleSkgPT4ge1xyXG4gICAgICAgIFJvdXRlci5wdXNoKGAvP2tleT0ke2FjdGl2ZVRhYktleX1gKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvL+WcqEluZGV46aG16Z2i5LiN6aKR57mB6K+35rGCcmVwb+S/oeaBr1xyXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgICAgICBpZiAoIWlzU2VydmVyKSB7IFxyXG4gICAgICAgICAgICB1c2VyUmVwb3MgJiYgY2FjaGUuc2V0KCd1c2VyUmVwb3MnLCB1c2VyUmVwb3MpXHJcbiAgICAgICAgICAgIHVzZXJTdGFycmVkUmVwb3MgJiYgIGNhY2hlLnNldCgndXNlclN0YXJyZWRSZXBvcycsIHVzZXJTdGFycmVkUmVwb3MpXHJcbiAgICAgICAgfVxyXG4gICAgfSwgW3VzZXJSZXBvcywgdXNlclN0YXJyZWRSZXBvc10pXHJcblxyXG4gICAgLy/ot7PovazliLAvc2VhcmNo6aG16Z2i5LiN55So6YeN5paw6K+35rGCcmVwb+S/oeaBr1xyXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgICAgICBpZiAoIWlzU2VydmVyKSB7XHJcbiAgICAgICAgICAgIGNhY2hlQXJyYXkodXNlclJlcG9zKVxyXG4gICAgICAgICAgICBjYWNoZUFycmF5KHVzZXJTdGFycmVkUmVwb3MpXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuXHJcblx0Y29uc3QgQmVmb3JlTG9naW4gPSAoKSA9PiAoXHJcblx0XHQ8PlxyXG5cdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cInJvb3RcIj5cclxuXHRcdFx0XHQ8QnV0dG9uIGhyZWY9e09BVVRIX1VSTH0+XHJcbiAgICAgICAgICAgICAgICAgICAgQ2xpY2sgdG8gbG9nIGludG8geW91ciBHaXRodWIgYWNjb3VudFxyXG4gICAgICAgICAgICAgICAgPC9CdXR0b24+XHJcblx0XHRcdDwvZGl2PlxyXG5cdFx0XHQ8c3R5bGUganN4PntgXHJcblx0XHRcdFx0LnJvb3Qge1xyXG5cdFx0XHRcdFx0ZGlzcGxheTogZmxleDtcclxuXHRcdFx0XHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG5cdFx0XHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdGB9PC9zdHlsZT5cclxuXHRcdDwvPlxyXG5cdClcclxuXHRcclxuXHRpZiAoIXVzZXIgfHwgIXVzZXIuaWQpIHtcclxuXHRcdHJldHVybiA8QmVmb3JlTG9naW4gLz5cclxuXHR9XHJcblxyXG5cdHJldHVybiAoXHJcblx0XHQ8PlxyXG5cdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cInJvb3RcIj5cclxuXHRcdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cInVzZXItaW5mb1wiPlxyXG5cdFx0XHRcdFx0PGltZyBzcmM9e3VzZXIuYXZhdGFyX3VybH0gYWx0PVwidXNlciBhdmF0YXJcIiBjbGFzc05hbWU9XCJ1c2VyLWF2YXRhclwiLz5cclxuXHRcdFx0XHRcdDxwIGNsYXNzTmFtZT1cInVzZXItbmFtZVwiPnt1c2VyLmxvZ2lufTwvcD5cclxuXHRcdFx0XHQ8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxUYWJzIFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUtleT17YWN0aXZlVGFiS2V5fSBcclxuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlVGFiQ2hhbmdlfSBcclxuICAgICAgICAgICAgICAgICAgICBhbmltYXRlZD17ZmFsc2V9XHJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZT1cImxhcmdlXCJcclxuICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICA8VGFiUGFuZSBrZXk9XCJyZXBvc1wiIHRhYj1cIlJlcG9zaXRvcmllc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dXNlclJlcG9zLm1hcChyZXBvID0+IDxSZXBvIGtleT17cmVwby5pZH0gcmVwbz17cmVwb30gLz4pfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvVGFiUGFuZT5cclxuICAgICAgICAgICAgICAgICAgICA8VGFiUGFuZSBrZXk9XCJzdGFyc1wiIHRhYj1cIlN0YXJzXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHt1c2VyU3RhcnJlZFJlcG9zLm1hcChyZXBvID0+IDxSZXBvIGtleT17cmVwby5pZH0gcmVwbz17cmVwb30gLz4pfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvVGFiUGFuZT5cclxuICAgICAgICAgICAgICAgIDwvVGFicz5cclxuXHRcdFx0PC9kaXY+XHJcblx0XHRcdDxzdHlsZSBqc3g+e2BcclxuXHRcdFx0XHQucm9vdCB7XHJcblx0XHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xyXG5cdFx0XHRcdFx0YWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XHJcblx0XHRcdFx0XHRwYWRkaW5nOiAyMHB4IDA7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC51c2VyLWluZm8ge1xyXG5cdFx0XHRcdFx0d2lkdGg6IDIwMHB4O1xyXG5cdFx0XHRcdFx0bWFyZ2luLXJpZ2h0OiA0MHB4O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQudXNlci1uYW1lIHtcclxuXHRcdFx0XHRcdGZvbnQtc2l6ZTogMjBweDtcclxuXHRcdFx0XHRcdGZvbnQtd2VpZ2h0OiAzMDA7XHJcblx0XHRcdFx0XHRtYXJnaW4tdG9wOiAxMHB4O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQudXNlci1hdmF0YXIge1xyXG5cdFx0XHRcdFx0d2lkdGg6IDEwMCU7XHJcblx0XHRcdFx0XHRib3JkZXItcmFkaXVzOiA0cHg7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRgfTwvc3R5bGU+XHJcblx0XHQ8Lz5cclxuXHQpXHJcbn1cclxuXHJcbmNvbnN0IGFwaSA9IHJlcXVpcmUoJy4uL2xpYi9hcGknKVxyXG4vL+iwg+eUqO+8miDmnI3liqHnq6/muLLmn5NpbmRleOaXtiAv5a6i5oi356uv5a+86Iiq5YiwaW5kZXjml7ZcclxuLy/mtY/op4jlmajnjq/looPvvJogYXhpb3MuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAveHh4JylcclxuLy9ub2Rl546v5aKD77yaIGF4aW9zLmdldCgnaHR0cDovL2xvY2FsaG9zdDo4MC94eHgnKVxyXG5JbmRleC5nZXRJbml0aWFsUHJvcHMgPSBhc3luYyAoeyByZXEsIHJlcywgcmVkdXhTdG9yZSB9KSA9PiB7XHJcbiAgICBjb25zdCB1c2VyID0gcmVkdXhTdG9yZS5nZXRTdGF0ZSgpLnVzZXI7XHJcbiAgICBpZiAoIXVzZXIgfHwgIXVzZXIuaWQgKSB7XHJcbiAgICAgICAgcmV0dXJuIHt9ICBcclxuICAgIH1cclxuICAgIGlmICghaXNTZXJ2ZXIpIHsgLy/mnI3liqHnq6/njq/looPkuI3kvb/nlKjnvJPlrZhcclxuICAgICAgICBjb25zdCB1c2VyUmVwb3MgPSBjYWNoZS5nZXQoJ3VzZXJSZXBvcycpO1xyXG4gICAgICAgIGNvbnN0IHVzZXJTdGFycmVkUmVwb3MgPSBjYWNoZS5nZXQoJ3VzZXJTdGFycmVkUmVwb3MnKVxyXG4gICAgICAgIGlmICh1c2VyUmVwb3MgJiYgdXNlclN0YXJyZWRSZXBvcykge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdXNlclJlcG9zLFxyXG4gICAgICAgICAgICAgICAgdXNlclN0YXJyZWRSZXBvcyAgICBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB1c2VyUmVwb3NSZXNwID0gYXdhaXQgYXBpLnJlcXVlc3QoXHJcbiAgICAgICAgeyB1cmw6ICcvdXNlci9yZXBvcycgfSwgXHJcbiAgICAgICAgcmVxLCBcclxuICAgICAgICByZXNcclxuICAgICk7XHJcbiAgICBjb25zdCB1c2VyU3RhcnJlZFJlcG9zUmVzcCA9IGF3YWl0IGFwaS5yZXF1ZXN0KFxyXG4gICAgICAgIHsgdXJsOiAnL3VzZXIvc3RhcnJlZCd9LFxyXG4gICAgICAgIHJlcSxcclxuICAgICAgICByZXNcclxuICAgICk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHVzZXJSZXBvczogdXNlclJlcG9zUmVzcC5kYXRhIHx8IFtdLFxyXG4gICAgICAgIHVzZXJTdGFycmVkUmVwb3M6IHVzZXJTdGFycmVkUmVwb3NSZXNwLmRhdGEgfHwgW11cclxuICAgIH1cclxufVxyXG5cclxuIl19 */\\n/*@ sourceURL=D:\\\\\\\\\\u7F16\\u7A0B\\\\\\\\\\u9879\\u76EE\\\\\\\\next\\u9879\\u76EE\\\\\\\\next-github\\\\\\\\pages\\\\\\\\index.js */\"));\n}\n\nvar api = require('../lib/api'); //调用： 服务端渲染index时 /客户端导航到index时\n//浏览器环境： axios.get('http://localhost:3000/xxx')\n//node环境： axios.get('http://localhost:80/xxx')\n\n\nIndex.getInitialProps = function _callee(_ref2) {\n  var req, res, reduxStore, user, userRepos, userStarredRepos, userReposResp, userStarredReposResp;\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          req = _ref2.req, res = _ref2.res, reduxStore = _ref2.reduxStore;\n          user = reduxStore.getState().user;\n\n          if (!(!user || !user.id)) {\n            _context.next = 4;\n            break;\n          }\n\n          return _context.abrupt(\"return\", {});\n\n        case 4:\n          if (isServer) {\n            _context.next = 9;\n            break;\n          }\n\n          //服务端环境不使用缓存\n          userRepos = cache.get('userRepos');\n          userStarredRepos = cache.get('userStarredRepos');\n\n          if (!(userRepos && userStarredRepos)) {\n            _context.next = 9;\n            break;\n          }\n\n          return _context.abrupt(\"return\", {\n            userRepos: userRepos,\n            userStarredRepos: userStarredRepos\n          });\n\n        case 9:\n          _context.next = 11;\n          return _regeneratorRuntime.awrap(api.request({\n            url: '/user/repos'\n          }, req, res));\n\n        case 11:\n          userReposResp = _context.sent;\n          _context.next = 14;\n          return _regeneratorRuntime.awrap(api.request({\n            url: '/user/starred'\n          }, req, res));\n\n        case 14:\n          userStarredReposResp = _context.sent;\n          return _context.abrupt(\"return\", {\n            userRepos: userReposResp.data || [],\n            userStarredRepos: userStarredReposResp.data || []\n          });\n\n        case 16:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n};","map":{"version":3,"sources":["D:/编程/项目/next项目/next-github/pages/index.js"],"names":["useSelector","useEffect","Repo","config","LRU","Router","useRouter","cacheArray","OAUTH_URL","TabPane","cache","maxAge","isServer","Index","userRepos","userStarredRepos","user","state","router","activeTabKey","query","key","handleTabChange","push","set","BeforeLogin","id","avatar_url","login","map","repo","api","require","getInitialProps","req","res","reduxStore","getState","get","request","url","userReposResp","userStarredReposResp","data"],"mappings":"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","sourcesContent":["import { useSelector } from 'react-redux'\r\nimport { Button, Tabs } from 'antd'\r\nimport { useEffect } from 'react'\r\nimport Repo from '../components/Repo'\r\nimport config from '../config'\r\nimport LRU from 'lru-cache'\r\nimport  Router, { useRouter } from 'next/router'\r\nimport { cacheArray } from '../lib/repo-basic-cache'\r\n\r\nconst { OAUTH_URL } = config;\r\nconst { TabPane } = Tabs;\r\nconst cache = new LRU({\r\n    maxAge: 1000 * 60 * 30 //30min\r\n})\r\nconst isServer = typeof window === 'undefined'\r\n\r\nexport default function Index({ userRepos = [], userStarredRepos = [] }) {\r\n    const user = useSelector(state => state.user);\r\n    const router = useRouter();\r\n    const activeTabKey = router.query.key || 'repos';\r\n\r\n    const handleTabChange = (activeTabKey) => {\r\n        Router.push(`/?key=${activeTabKey}`)\r\n    }\r\n    \r\n    //在Index页面不频繁请求repo信息\r\n    useEffect(() => {\r\n        if (!isServer) { \r\n            userRepos && cache.set('userRepos', userRepos)\r\n            userStarredRepos &&  cache.set('userStarredRepos', userStarredRepos)\r\n        }\r\n    }, [userRepos, userStarredRepos])\r\n\r\n    //跳转到/search页面不用重新请求repo信息\r\n    useEffect(() => {\r\n        if (!isServer) {\r\n            cacheArray(userRepos)\r\n            cacheArray(userStarredRepos)\r\n        }\r\n    })\r\n\r\n\tconst BeforeLogin = () => (\r\n\t\t<>\r\n\t\t\t<div className=\"root\">\r\n\t\t\t\t<Button href={OAUTH_URL}>\r\n                    Click to log into your Github account\r\n                </Button>\r\n\t\t\t</div>\r\n\t\t\t<style jsx>{`\r\n\t\t\t\t.root {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t}\r\n\t\t\t`}</style>\r\n\t\t</>\r\n\t)\r\n\t\r\n\tif (!user || !user.id) {\r\n\t\treturn <BeforeLogin />\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div className=\"root\">\r\n\t\t\t\t<div className=\"user-info\">\r\n\t\t\t\t\t<img src={user.avatar_url} alt=\"user avatar\" className=\"user-avatar\"/>\r\n\t\t\t\t\t<p className=\"user-name\">{user.login}</p>\r\n\t\t\t\t</div>\r\n                <Tabs \r\n                    activeKey={activeTabKey} \r\n                    onChange={handleTabChange} \r\n                    animated={false}\r\n                    size=\"large\"\r\n                >\r\n                    <TabPane key=\"repos\" tab=\"Repositories\">\r\n                        {userRepos.map(repo => <Repo key={repo.id} repo={repo} />)}\r\n                    </TabPane>\r\n                    <TabPane key=\"stars\" tab=\"Stars\">\r\n                        {userStarredRepos.map(repo => <Repo key={repo.id} repo={repo} />)}\r\n                    </TabPane>\r\n                </Tabs>\r\n\t\t\t</div>\r\n\t\t\t<style jsx>{`\r\n\t\t\t\t.root {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: flex-start;\r\n\t\t\t\t\tpadding: 20px 0;\r\n\t\t\t\t}\r\n\t\t\t\t.user-info {\r\n\t\t\t\t\twidth: 200px;\r\n\t\t\t\t\tmargin-right: 40px;\r\n\t\t\t\t}\r\n\t\t\t\t.user-name {\r\n\t\t\t\t\tfont-size: 20px;\r\n\t\t\t\t\tfont-weight: 300;\r\n\t\t\t\t\tmargin-top: 10px;\r\n\t\t\t\t}\r\n\t\t\t\t.user-avatar {\r\n\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\tborder-radius: 4px;\r\n\t\t\t\t}\r\n\t\t\t`}</style>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nconst api = require('../lib/api')\r\n//调用： 服务端渲染index时 /客户端导航到index时\r\n//浏览器环境： axios.get('http://localhost:3000/xxx')\r\n//node环境： axios.get('http://localhost:80/xxx')\r\nIndex.getInitialProps = async ({ req, res, reduxStore }) => {\r\n    const user = reduxStore.getState().user;\r\n    if (!user || !user.id ) {\r\n        return {}  \r\n    }\r\n    if (!isServer) { //服务端环境不使用缓存\r\n        const userRepos = cache.get('userRepos');\r\n        const userStarredRepos = cache.get('userStarredRepos')\r\n        if (userRepos && userStarredRepos) {\r\n            return {\r\n                userRepos,\r\n                userStarredRepos    \r\n            }\r\n        }\r\n    }\r\n\r\n    const userReposResp = await api.request(\r\n        { url: '/user/repos' }, \r\n        req, \r\n        res\r\n    );\r\n    const userStarredReposResp = await api.request(\r\n        { url: '/user/starred'},\r\n        req,\r\n        res\r\n    );\r\n    return {\r\n        userRepos: userReposResp.data || [],\r\n        userStarredRepos: userStarredReposResp.data || []\r\n    }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}