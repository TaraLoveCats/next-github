{"ast":null,"code":"import _Row from \"antd/lib/row\";\nimport _Pagination from \"antd/lib/pagination\";\nimport _Statistic from \"antd/lib/statistic\";\nimport _Col from \"antd/lib/col\";\nimport _List from \"antd/lib/list\";\nimport _Icon from \"antd/lib/icon\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport Router, { useRouter } from 'next/router';\nimport { memo, isValidElement, useEffect } from 'react';\nimport Link from 'next/link';\nimport Repo from '../components/Repo';\nimport data from '../testData';\nimport { cacheArray } from '../lib/repo-basic-cache';\n\nconst api = require('../lib/api');\n\nconst LANGUAGES = ['JavaScript', 'TypeScript', 'HTML', 'CSS', 'Java', 'Rust', 'Python', 'C#', 'Swift', 'C++', 'C'];\nconst SORT_TYPES = [{\n  name: 'Best Match'\n}, {\n  name: 'Most Stars',\n  value: 'stars',\n  order: 'desc'\n}, {\n  name: 'Fewest Stars',\n  value: 'stars',\n  order: 'asc'\n}, {\n  name: 'Most Forks',\n  value: 'forks',\n  order: 'desc'\n}, {\n  name: 'Fewest Forks',\n  value: 'forks',\n  order: 'asc'\n}];\nconst per_page = 10;\nconst selectedItemStyle = {\n  borderLeft: '2px solid #e36209',\n  fontWeight: 100\n};\nconst initRepos = {\n  total_count: 0,\n  items: []\n};\nconst isServer = true;\n\nfunction noop() {}\n\nconst FilterLink = memo(({\n  name,\n  q,\n  lang,\n  sort,\n  order,\n  page\n}) => {\n  let queryString = `?q=${encodeURIComponent(q)}`;\n  lang && (queryString += `&lang=${encodeURIComponent(lang)}`);\n  sort && (queryString += `&sort=${encodeURIComponent(sort)}&order=${encodeURIComponent(order || 'desc')}`);\n  page && (queryString += `&page=${encodeURIComponent(page)}`);\n  queryString += `&per_page=${encodeURIComponent(per_page)}`;\n  return __jsx(Link, {\n    href: `/search${queryString}`\n  }, isValidElement(name) ? name : __jsx(\"a\", null, name));\n});\nexport default function Search({\n  repos = initRepos,\n  colors\n}) {\n  const router = useRouter();\n  const querys = Object.assign({}, router.query);\n  console.log(querys);\n  Object.keys(querys).forEach(key => {\n    querys[key] = decodeURIComponent(querys[key]);\n  });\n  console.log(querys);\n  const {\n    q,\n    sort,\n    order,\n    lang,\n    page\n  } = querys;\n  useEffect(() => {\n    if (!isServer) {\n      cacheArray(repos.items);\n    }\n  });\n\n  const resetLanguage = () => {\n    const queryObj = {};\n    q && (queryObj['q'] = q);\n    sort && (queryObj['sort'] = sort);\n    order && (queryObj['order'] = order);\n    per_page && (queryObj['per_page'] = per_page);\n    Router.push({\n      pathname: '/search',\n      query: queryObj\n    });\n  };\n\n  return __jsx(\"div\", {\n    className: \"jsx-2076330023\" + \" \" + \"root\"\n  }, __jsx(_Row, {\n    gutter: 20\n  }, __jsx(_Col, {\n    span: 6\n  }, __jsx(_List, {\n    bordered: true,\n    header: __jsx(\"span\", {\n      className: \"jsx-2076330023\" + \" \" + \"list-header\"\n    }, \"Languages\"),\n    style: {\n      marginBottom: 20\n    },\n    dataSource: LANGUAGES,\n    renderItem: item => {\n      const selected = item === lang;\n      return __jsx(_List.Item, {\n        style: selected ? selectedItemStyle : null,\n        actions: selected ? [__jsx(_Icon, {\n          type: \"close-circle\",\n          theme: \"filled\",\n          onClick: resetLanguage\n        })] : null\n      }, selected ? __jsx(\"span\", {\n        className: \"jsx-2076330023\"\n      }, item) : __jsx(FilterLink, _extends({}, querys, {\n        lang: item,\n        name: item,\n        page: null\n      })));\n    }\n  }), __jsx(_List, {\n    bordered: true,\n    header: __jsx(\"span\", {\n      className: \"jsx-2076330023\" + \" \" + \"list-header\"\n    }, \"Sort By\"),\n    dataSource: SORT_TYPES,\n    renderItem: item => {\n      let selected = false;\n\n      if (item.name === 'Best Match' && !sort) {\n        selected = true;\n      } else if (item.value === sort && item.order === order) {\n        selected = true;\n      }\n\n      return __jsx(_List.Item, {\n        style: selected ? selectedItemStyle : null\n      }, selected ? __jsx(\"span\", {\n        className: \"jsx-2076330023\"\n      }, item.name) : __jsx(FilterLink, _extends({}, querys, {\n        name: item.name,\n        sort: item.value,\n        order: item.order,\n        page: null\n      })));\n    }\n  })), __jsx(_Col, {\n    span: 18\n  }, __jsx(\"h3\", {\n    className: \"jsx-2076330023\" + \" \" + \"repos-title\"\n  }, __jsx(_Statistic, {\n    value: repos.total_count\n  }), __jsx(\"span\", {\n    className: \"jsx-2076330023\"\n  }, \"\\xA0repository results\")), repos.items.map(repo => __jsx(Repo, {\n    repo: repo,\n    key: repo.id,\n    colors: colors\n  })), __jsx(\"div\", {\n    className: \"jsx-2076330023\" + \" \" + \"pagination\"\n  }, __jsx(_Pagination, {\n    pageSize: per_page,\n    current: +page || 1,\n    total: 1000 //github限制返回1000条\n    ,\n    onChange: noop,\n    itemRender: (page, type, ol) => {\n      const p = type === 'page' ? page : type === 'prev' ? page - 1 : page + 1;\n      const name = type === 'page' ? page : ol;\n      return __jsx(FilterLink, _extends({}, querys, {\n        page: p,\n        name: name\n      }));\n    }\n  })))), __jsx(_JSXStyle, {\n    id: \"2076330023\"\n  }, \".root.jsx-2076330023{padding:30px 0;}.repos-title.jsx-2076330023{border-bottom:1px solid #ddd;font-size:24px;line-height:1.5;padding-bottom:20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;}.list-header.jsx-2076330023{font-weight:700;font-size:16px;}.list-item.jsx-2076330023{position:relative;}.close-circle.jsx-2076330023{position:absolute;right:20px;top:20px;}.pagination.jsx-2076330023{padding:20px;text-align:center;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6XFznvJbnqItcXOmhueebrlxcbmV4dOmhueebrlxcbmV4dC1naXRodWJcXHBhZ2VzXFxzZWFyY2guanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBdUx3QixBQUdvQyxBQUdjLEFBUWIsQUFJRSxBQUdBLEFBS0wsYUFDSyxFQXZCdEIsQ0FXbUIsRUFJbkIsQUFHZSxXQWZJLEFBZ0JOLEVBUGIsQUFZQSxPQUpBLE1BaEJvQixnQkFDSSxvQkFDUCwwRUFDYyx5R0FDL0IiLCJmaWxlIjoiRDpcXOe8lueoi1xc6aG555uuXFxuZXh06aG555uuXFxuZXh0LWdpdGh1YlxccGFnZXNcXHNlYXJjaC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSb3V0ZXIsIHsgdXNlUm91dGVyIH0gZnJvbSAnbmV4dC9yb3V0ZXInXHJcbmltcG9ydCB7IG1lbW8sIGlzVmFsaWRFbGVtZW50LCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCdcclxuaW1wb3J0IHsgUm93LCBDb2wsIExpc3QsIFBhZ2luYXRpb24sIFN0YXRpc3RpYywgSWNvbiB9IGZyb20gJ2FudGQnXHJcbmltcG9ydCBMaW5rIGZyb20gJ25leHQvbGluaydcclxuaW1wb3J0IFJlcG8gZnJvbSAnLi4vY29tcG9uZW50cy9SZXBvJ1xyXG5pbXBvcnQgZGF0YSBmcm9tICcuLi90ZXN0RGF0YSdcclxuaW1wb3J0IHsgY2FjaGVBcnJheSB9IGZyb20gJy4uL2xpYi9yZXBvLWJhc2ljLWNhY2hlJ1xyXG5jb25zdCBhcGkgPSByZXF1aXJlKCcuLi9saWIvYXBpJylcclxuXHJcbmNvbnN0IExBTkdVQUdFUyA9IFsnSmF2YVNjcmlwdCcsICdUeXBlU2NyaXB0JywgJ0hUTUwnLCAnQ1NTJywgJ0phdmEnLCAnUnVzdCcsICdQeXRob24nLCAnQyMnLCAnU3dpZnQnLCAnQysrJywgJ0MnXTtcclxuY29uc3QgU09SVF9UWVBFUyA9IFtcclxuICAgIHtcclxuICAgICAgICBuYW1lOiAnQmVzdCBNYXRjaCcsXHJcbiAgICB9LCAgXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogJ01vc3QgU3RhcnMnLFxyXG4gICAgICAgIHZhbHVlOiAnc3RhcnMnLFxyXG4gICAgICAgIG9yZGVyOiAnZGVzYycsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6ICdGZXdlc3QgU3RhcnMnLFxyXG4gICAgICAgIHZhbHVlOiAnc3RhcnMnLFxyXG4gICAgICAgIG9yZGVyOiAnYXNjJyxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogJ01vc3QgRm9ya3MnLFxyXG4gICAgICAgIHZhbHVlOiAnZm9ya3MnLFxyXG4gICAgICAgIG9yZGVyOiAnZGVzYycsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6ICdGZXdlc3QgRm9ya3MnLFxyXG4gICAgICAgIHZhbHVlOiAnZm9ya3MnLFxyXG4gICAgICAgIG9yZGVyOiAnYXNjJyxcclxuICAgIH0sXHJcbl07XHJcbmNvbnN0IHBlcl9wYWdlID0gMTA7XHJcbmNvbnN0IHNlbGVjdGVkSXRlbVN0eWxlID0ge1xyXG4gICAgYm9yZGVyTGVmdDogJzJweCBzb2xpZCAjZTM2MjA5JyxcclxuICAgIGZvbnRXZWlnaHQ6IDEwMCxcclxufVxyXG5jb25zdCBpbml0UmVwb3MgPSB7XHJcbiAgICB0b3RhbF9jb3VudDogMCxcclxuICAgIGl0ZW1zOiBbXVxyXG59O1xyXG5jb25zdCBpc1NlcnZlciA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnO1xyXG5mdW5jdGlvbiBub29wKCkgeyB9XHJcblxyXG5jb25zdCBGaWx0ZXJMaW5rID0gbWVtbygoeyBuYW1lLCBxLCBsYW5nLCBzb3J0LCBvcmRlciwgcGFnZSB9KSA9PiB7XHJcbiAgICBsZXQgcXVlcnlTdHJpbmcgPSBgP3E9JHtlbmNvZGVVUklDb21wb25lbnQocSl9YDtcclxuICAgIGxhbmcgJiYgKHF1ZXJ5U3RyaW5nICs9IGAmbGFuZz0ke2VuY29kZVVSSUNvbXBvbmVudChsYW5nKX1gKTtcclxuICAgIHNvcnQgJiYgKHF1ZXJ5U3RyaW5nICs9IGAmc29ydD0ke2VuY29kZVVSSUNvbXBvbmVudChzb3J0KX0mb3JkZXI9JHtlbmNvZGVVUklDb21wb25lbnQob3JkZXIgfHwgJ2Rlc2MnKX1gKTtcclxuICAgIHBhZ2UgJiYgKHF1ZXJ5U3RyaW5nICs9IGAmcGFnZT0ke2VuY29kZVVSSUNvbXBvbmVudChwYWdlKX1gKTtcclxuICAgIHF1ZXJ5U3RyaW5nICs9IGAmcGVyX3BhZ2U9JHtlbmNvZGVVUklDb21wb25lbnQocGVyX3BhZ2UpfWA7XHJcbiAgICBcclxuICAgIHJldHVybiAoXHJcbiAgICAgICAgPExpbmsgaHJlZj17YC9zZWFyY2gke3F1ZXJ5U3RyaW5nfWB9PiBcclxuICAgICAgICAgICAge2lzVmFsaWRFbGVtZW50KG5hbWUpID8gbmFtZSA6IDxhPntuYW1lfTwvYT59XHJcbiAgICAgICAgPC9MaW5rPlxyXG4gICAgKVxyXG59KTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFNlYXJjaCh7IHJlcG9zID0gaW5pdFJlcG9zLCBjb2xvcnMgfSkge1xyXG4gICAgY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCk7XHJcbiAgICBjb25zdCB7IC4uLnF1ZXJ5cyB9ID0gcm91dGVyLnF1ZXJ5O1xyXG4gICAgY29uc29sZS5sb2cocXVlcnlzKVxyXG4gICAgT2JqZWN0LmtleXMocXVlcnlzKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgcXVlcnlzW2tleV0gPSBkZWNvZGVVUklDb21wb25lbnQocXVlcnlzW2tleV0pO1xyXG4gICAgfSlcclxuICAgIGNvbnNvbGUubG9nKHF1ZXJ5cylcclxuICAgIGNvbnN0IHsgcSwgc29ydCwgb3JkZXIsIGxhbmcsIHBhZ2UgfSA9IHF1ZXJ5cztcclxuXHJcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgICAgIGlmICghaXNTZXJ2ZXIpIHtcclxuICAgICAgICAgICAgY2FjaGVBcnJheShyZXBvcy5pdGVtcylcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnN0IHJlc2V0TGFuZ3VhZ2UgPSAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcXVlcnlPYmogPSB7fTtcclxuICAgICAgICBxICYmIChxdWVyeU9ialsncSddID0gcSk7XHJcbiAgICAgICAgc29ydCAmJiAocXVlcnlPYmpbJ3NvcnQnXSA9IHNvcnQpO1xyXG4gICAgICAgIG9yZGVyICYmIChxdWVyeU9ialsnb3JkZXInXSA9IG9yZGVyKTtcclxuICAgICAgICBwZXJfcGFnZSAmJiAocXVlcnlPYmpbJ3Blcl9wYWdlJ10gPSBwZXJfcGFnZSk7XHJcblxyXG4gICAgICAgIFJvdXRlci5wdXNoKHtcclxuICAgICAgICAgICAgcGF0aG5hbWU6ICcvc2VhcmNoJyxcclxuICAgICAgICAgICAgcXVlcnk6IHF1ZXJ5T2JqXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIHJldHVybiAoXHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyb290XCI+XHJcbiAgICAgICAgICAgIDxSb3cgZ3V0dGVyPXsyMH0+XHJcbiAgICAgICAgICAgICAgICA8Q29sIHNwYW49ezZ9PlxyXG4gICAgICAgICAgICAgICAgICAgIDxMaXN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlcmVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcj17PHNwYW4gY2xhc3NOYW1lPVwibGlzdC1oZWFkZXJcIj5MYW5ndWFnZXM8L3NwYW4+fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBtYXJnaW5Cb3R0b206IDIwIH19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2U9e0xBTkdVQUdFU31cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVySXRlbT17aXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZCA9IGl0ZW0gPT09IGxhbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPExpc3QuSXRlbSBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3NlbGVjdGVkID8gc2VsZWN0ZWRJdGVtU3R5bGUgOiBudWxsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zPXtzZWxlY3RlZCA/IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzxJY29uIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJjbG9zZS1jaXJjbGVcIiBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVtZT1cImZpbGxlZFwiIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3Jlc2V0TGFuZ3VhZ2V9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPl0gXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IG51bGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3NlbGVjdGVkID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPntpdGVtfTwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxGaWx0ZXJMaW5rXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgey4uLnF1ZXJ5c31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYW5nPXtpdGVtfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e2l0ZW19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZT17bnVsbH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0xpc3QuSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICAgICAgICAvPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICA8TGlzdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBib3JkZXJlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI9ezxzcGFuIGNsYXNzTmFtZT1cImxpc3QtaGVhZGVyXCI+U29ydCBCeTwvc3Bhbj59XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2U9e1NPUlRfVFlQRVN9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlckl0ZW09e2l0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5uYW1lID09PSAnQmVzdCBNYXRjaCcgJiYgIXNvcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0udmFsdWUgPT09IHNvcnQgJiYgaXRlbS5vcmRlciA9PT0gb3JkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxMaXN0Lkl0ZW0gc3R5bGU9e3NlbGVjdGVkID8gc2VsZWN0ZWRJdGVtU3R5bGUgOiBudWxsfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3NlbGVjdGVkID8gPHNwYW4+e2l0ZW0ubmFtZX08L3NwYW4+IDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxGaWx0ZXJMaW5rXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgey4uLnF1ZXJ5c31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtpdGVtLm5hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydD17aXRlbS52YWx1ZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcj17aXRlbS5vcmRlcn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlPXtudWxsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvTGlzdC5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICA8L0NvbD5cclxuICAgICAgICAgICAgICAgIDxDb2wgc3Bhbj17MTh9PlxyXG4gICAgICAgICAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJyZXBvcy10aXRsZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8U3RhdGlzdGljIHZhbHVlPXtyZXBvcy50b3RhbF9jb3VudH0gLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4+Jm5ic3A7cmVwb3NpdG9yeSByZXN1bHRzPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvaDM+XHJcbiAgICAgICAgICAgICAgICAgICAge3JlcG9zLml0ZW1zLm1hcChyZXBvID0+IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgPFJlcG8gcmVwbz17cmVwb30ga2V5PXtyZXBvLmlkfSBjb2xvcnM9e2NvbG9yc30gLz5cclxuICAgICAgICAgICAgICAgICAgICApKX1cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhZ2luYXRpb25cIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPFBhZ2luYXRpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VTaXplPXtwZXJfcGFnZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ9eytwYWdlIHx8IDF9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbD17MTAwMH0gLy9naXRodWLpmZDliLbov5Tlm54xMDAw5p2hXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17bm9vcH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1SZW5kZXI9eyhwYWdlLCB0eXBlLCBvbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHAgPSB0eXBlID09PSAncGFnZScgPyBwYWdlIDogdHlwZSA9PT0gJ3ByZXYnID8gcGFnZSAtIDEgOiBwYWdlICsgMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gdHlwZSA9PT0gJ3BhZ2UnID8gcGFnZSA6IG9sO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxGaWx0ZXJMaW5rXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Li4ucXVlcnlzfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZT17cH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e25hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvQ29sPlxyXG4gICAgICAgICAgICA8L1Jvdz5cclxuICAgICAgICAgICAgPHN0eWxlIGpzeD57YFxyXG4gICAgICAgICAgICAgICAgLnJvb3Qge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDMwcHggMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC5yZXBvcy10aXRsZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNkZGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAyNHB4O1xyXG4gICAgICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjU7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZy1ib3R0b206IDIwcHg7XHJcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtc3RhcnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAubGlzdC1oZWFkZXIge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAxNnB4O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLmxpc3QtaXRlbSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLmNsb3NlLWNpcmNsZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0OiAyMHB4O1xyXG4gICAgICAgICAgICAgICAgICAgIHRvcDogMjBweDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC5wYWdpbmF0aW9uIHtcclxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAyMHB4O1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYH08L3N0eWxlPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgKVxyXG59XHJcblxyXG5TZWFyY2guZ2V0SW5pdGlhbFByb3BzID0gYXN5bmMgKHsgcXVlcnksIGFzUGF0aCwgcmVxLCByZXMgfSkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coJ1NlYXJjaCBnZXRJbml0aWFsUHJvcHMgY2FsbGVkJyk7XHJcbiAgICBjb25zb2xlLmxvZyhxdWVyeSlcclxuICAgIGNvbnN0IHsgcSwgbGFuZywgc29ydCwgb3JkZXIsIHBhZ2UsIHBlcl9wYWdlfSA9IHF1ZXJ5O1xyXG5cclxuICAgIGlmICghcXVlcnkucSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlcG9zOiBpbml0UmVwb3NcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gY29uc29sZS5sb2coYXNQYXRoKVxyXG4gICAgXHJcbiAgICAvLyBjb25zdCBxdWVyeUFyciA9IGFzUGF0aC5zcGxpdCgnPycpWzFdLnNwbGl0KCcmJyk7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhxdWVyeUFycilcclxuICAgIC8vIGNvbnN0IHF1ZXJ5T2JqID0gcXVlcnlBcnIucmVkdWNlKChvYmosIGVudHJ5KSA9PiB7XHJcbiAgICAvLyAgICAgY29uc3QgZW50cnlBcnIgPSBlbnRyeS5zcGxpdCgnPScpO1xyXG4gICAgLy8gICAgIG9ialtlbnRyeUFyclswXV0gPSBlbmNvZGVVUklDb21wb25lbnQoZW50cnlBcnJbMV0pOyAvL0MrKyAtPiBDJTJCJTJCXHJcbiAgICAvLyAgICAgcmV0dXJuIG9iajsgXHJcbiAgICAvLyB9LCB7fSk7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhxdWVyeU9iailcclxuICAgIC8vIGNvbnN0IHsgcSwgbGFuZywgc29ydCwgb3JkZXIsIHBhZ2UsIHBlcl9wYWdlfSA9IHF1ZXJ5T2JqO1xyXG4gICAgLy8gP3E9cmVhY3QrbGFuZ3VhZ2U6amF2YXNjcmlwdCZzb3J0PXN0YXJzJm9yZGVyPWRlc2MmcGFnZT0yXHJcbiAgICBsZXQgcXVlcnlTdHJpbmcgPSBgP3E9JHtxfWA7XHJcbiAgICBsYW5nICYmIChxdWVyeVN0cmluZyArPSBgK2xhbmd1YWdlOiR7bGFuZ31gKTtcclxuICAgIHNvcnQgJiYgKHF1ZXJ5U3RyaW5nICs9IGAmc29ydD0ke3NvcnR9Jm9yZGVyPSR7b3JkZXIgfHwgJ2Rlc2MnfWApO1xyXG4gICAgcGFnZSAmJiAocXVlcnlTdHJpbmcgKz0gYCZwYWdlPSR7cGFnZX1gKTtcclxuICAgIHF1ZXJ5U3RyaW5nICs9IGAmcGVyX3BhZ2U9JHtwZXJfcGFnZX1gO1xyXG4gICAgXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhcGkucmVxdWVzdCh7IFxyXG4gICAgICAgIHVybDogYC9zZWFyY2gvcmVwb3NpdG9yaWVzJHtxdWVyeVN0cmluZ31gIFxyXG4gICAgfSwgcmVxLCByZXMpO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVwb3M6IHJlc3VsdC5kYXRhIHx8IGRhdGEucmVhY3RfcmVwb3NcclxuICAgIH1cclxufSJdfQ== */\\n/*@ sourceURL=D:\\\\\\\\\\u7F16\\u7A0B\\\\\\\\\\u9879\\u76EE\\\\\\\\next\\u9879\\u76EE\\\\\\\\next-github\\\\\\\\pages\\\\\\\\search.js */\"));\n}\n\nSearch.getInitialProps = async ({\n  query,\n  asPath,\n  req,\n  res\n}) => {\n  console.log('Search getInitialProps called');\n  console.log(query);\n  const {\n    q,\n    lang,\n    sort,\n    order,\n    page,\n    per_page\n  } = query;\n\n  if (!query.q) {\n    return {\n      repos: initRepos\n    };\n  } // console.log(asPath)\n  // const queryArr = asPath.split('?')[1].split('&');\n  // console.log(queryArr)\n  // const queryObj = queryArr.reduce((obj, entry) => {\n  //     const entryArr = entry.split('=');\n  //     obj[entryArr[0]] = encodeURIComponent(entryArr[1]); //C++ -> C%2B%2B\n  //     return obj; \n  // }, {});\n  // console.log(queryObj)\n  // const { q, lang, sort, order, page, per_page} = queryObj;\n  // ?q=react+language:javascript&sort=stars&order=desc&page=2\n\n\n  let queryString = `?q=${q}`;\n  lang && (queryString += `+language:${lang}`);\n  sort && (queryString += `&sort=${sort}&order=${order || 'desc'}`);\n  page && (queryString += `&page=${page}`);\n  queryString += `&per_page=${per_page}`;\n  const result = await api.request({\n    url: `/search/repositories${queryString}`\n  }, req, res);\n  return {\n    repos: result.data || data.react_repos\n  };\n};","map":{"version":3,"sources":["D:/编程/项目/next项目/next-github/pages/search.js"],"names":["Router","useRouter","memo","isValidElement","useEffect","Link","Repo","data","cacheArray","api","require","LANGUAGES","SORT_TYPES","name","value","order","per_page","selectedItemStyle","borderLeft","fontWeight","initRepos","total_count","items","isServer","noop","FilterLink","q","lang","sort","page","queryString","encodeURIComponent","Search","repos","colors","router","querys","query","console","log","Object","keys","forEach","key","decodeURIComponent","resetLanguage","queryObj","push","pathname","marginBottom","item","selected","map","repo","id","type","ol","p","getInitialProps","asPath","req","res","result","request","url","react_repos"],"mappings":"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","sourcesContent":["import Router, { useRouter } from 'next/router'\r\nimport { memo, isValidElement, useEffect } from 'react'\r\nimport { Row, Col, List, Pagination, Statistic, Icon } from 'antd'\r\nimport Link from 'next/link'\r\nimport Repo from '../components/Repo'\r\nimport data from '../testData'\r\nimport { cacheArray } from '../lib/repo-basic-cache'\r\nconst api = require('../lib/api')\r\n\r\nconst LANGUAGES = ['JavaScript', 'TypeScript', 'HTML', 'CSS', 'Java', 'Rust', 'Python', 'C#', 'Swift', 'C++', 'C'];\r\nconst SORT_TYPES = [\r\n    {\r\n        name: 'Best Match',\r\n    },  \r\n    {\r\n        name: 'Most Stars',\r\n        value: 'stars',\r\n        order: 'desc',\r\n    },\r\n    {\r\n        name: 'Fewest Stars',\r\n        value: 'stars',\r\n        order: 'asc',\r\n    },\r\n    {\r\n        name: 'Most Forks',\r\n        value: 'forks',\r\n        order: 'desc',\r\n    },\r\n    {\r\n        name: 'Fewest Forks',\r\n        value: 'forks',\r\n        order: 'asc',\r\n    },\r\n];\r\nconst per_page = 10;\r\nconst selectedItemStyle = {\r\n    borderLeft: '2px solid #e36209',\r\n    fontWeight: 100,\r\n}\r\nconst initRepos = {\r\n    total_count: 0,\r\n    items: []\r\n};\r\nconst isServer = typeof window === 'undefined';\r\nfunction noop() { }\r\n\r\nconst FilterLink = memo(({ name, q, lang, sort, order, page }) => {\r\n    let queryString = `?q=${encodeURIComponent(q)}`;\r\n    lang && (queryString += `&lang=${encodeURIComponent(lang)}`);\r\n    sort && (queryString += `&sort=${encodeURIComponent(sort)}&order=${encodeURIComponent(order || 'desc')}`);\r\n    page && (queryString += `&page=${encodeURIComponent(page)}`);\r\n    queryString += `&per_page=${encodeURIComponent(per_page)}`;\r\n    \r\n    return (\r\n        <Link href={`/search${queryString}`}> \r\n            {isValidElement(name) ? name : <a>{name}</a>}\r\n        </Link>\r\n    )\r\n});\r\n\r\nexport default function Search({ repos = initRepos, colors }) {\r\n    const router = useRouter();\r\n    const { ...querys } = router.query;\r\n    console.log(querys)\r\n    Object.keys(querys).forEach(key => {\r\n        querys[key] = decodeURIComponent(querys[key]);\r\n    })\r\n    console.log(querys)\r\n    const { q, sort, order, lang, page } = querys;\r\n\r\n    useEffect(() => {\r\n        if (!isServer) {\r\n            cacheArray(repos.items)\r\n        }\r\n    })\r\n\r\n    const resetLanguage = () => {\r\n        const queryObj = {};\r\n        q && (queryObj['q'] = q);\r\n        sort && (queryObj['sort'] = sort);\r\n        order && (queryObj['order'] = order);\r\n        per_page && (queryObj['per_page'] = per_page);\r\n\r\n        Router.push({\r\n            pathname: '/search',\r\n            query: queryObj\r\n        })\r\n    }\r\n    return (\r\n        <div className=\"root\">\r\n            <Row gutter={20}>\r\n                <Col span={6}>\r\n                    <List\r\n                        bordered\r\n                        header={<span className=\"list-header\">Languages</span>}\r\n                        style={{ marginBottom: 20 }}\r\n                        dataSource={LANGUAGES}\r\n                        renderItem={item => {\r\n                            const selected = item === lang;\r\n                            return (                                \r\n                                <List.Item \r\n                                    style={selected ? selectedItemStyle : null}\r\n                                    actions={selected ? \r\n                                        [<Icon \r\n                                            type=\"close-circle\" \r\n                                            theme=\"filled\" \r\n                                            onClick={resetLanguage}\r\n                                        />] \r\n                                        : null\r\n                                    }\r\n                                >\r\n                                    {selected ?\r\n                                        <span>{item}</span>\r\n                                        :\r\n                                        <FilterLink\r\n                                            {...querys}\r\n                                            lang={item}\r\n                                            name={item}\r\n                                            page={null}\r\n                                        />\r\n                                    }\r\n                                </List.Item>\r\n                            )\r\n                        }}\r\n                    />\r\n\r\n                    <List\r\n                        bordered\r\n                        header={<span className=\"list-header\">Sort By</span>}\r\n                        dataSource={SORT_TYPES}\r\n                        renderItem={item => {\r\n                            let selected = false;\r\n                            if (item.name === 'Best Match' && !sort) {\r\n                                selected = true;\r\n                            } else if (item.value === sort && item.order === order) {\r\n                                selected = true;\r\n                            }\r\n                            return (\r\n                                <List.Item style={selected ? selectedItemStyle : null}>\r\n                                    {selected ? <span>{item.name}</span> :\r\n                                        <FilterLink\r\n                                            {...querys}\r\n                                            name={item.name}\r\n                                            sort={item.value}\r\n                                            order={item.order}\r\n                                            page={null}\r\n                                        />\r\n                                    }\r\n                                </List.Item>\r\n                            )\r\n                        }}\r\n                    />\r\n                </Col>\r\n                <Col span={18}>\r\n                    <h3 className=\"repos-title\">\r\n                        <Statistic value={repos.total_count} />\r\n                        <span>&nbsp;repository results</span>\r\n                    </h3>\r\n                    {repos.items.map(repo => (\r\n                        <Repo repo={repo} key={repo.id} colors={colors} />\r\n                    ))}\r\n                    <div className=\"pagination\">\r\n                        <Pagination\r\n                            pageSize={per_page}\r\n                            current={+page || 1}\r\n                            total={1000} //github限制返回1000条\r\n                            onChange={noop}\r\n                            itemRender={(page, type, ol) => {\r\n                                const p = type === 'page' ? page : type === 'prev' ? page - 1 : page + 1;\r\n                                const name = type === 'page' ? page : ol;\r\n                                return (\r\n                                    <FilterLink\r\n                                        {...querys}\r\n                                        page={p}\r\n                                        name={name}\r\n                                    />\r\n                                )\r\n                            }}\r\n                        />\r\n                    </div>\r\n                </Col>\r\n            </Row>\r\n            <style jsx>{`\r\n                .root {\r\n                    padding: 30px 0;\r\n                }\r\n                .repos-title {\r\n                    border-bottom: 1px solid #ddd;\r\n                    font-size: 24px;\r\n                    line-height: 1.5;\r\n                    padding-bottom: 20px;\r\n                    display: flex;\r\n                    justify-content: flex-start;\r\n                }\r\n                .list-header {\r\n                    font-weight: 700;\r\n                    font-size: 16px;\r\n                }\r\n                .list-item {\r\n                    position: relative;\r\n                }\r\n                .close-circle {\r\n                    position: absolute;\r\n                    right: 20px;\r\n                    top: 20px;\r\n                }\r\n                .pagination {\r\n                    padding: 20px;\r\n                    text-align: center;\r\n                }\r\n            `}</style>\r\n        </div>\r\n    )\r\n}\r\n\r\nSearch.getInitialProps = async ({ query, asPath, req, res }) => {\r\n    console.log('Search getInitialProps called');\r\n    console.log(query)\r\n    const { q, lang, sort, order, page, per_page} = query;\r\n\r\n    if (!query.q) {\r\n        return {\r\n            repos: initRepos\r\n        }\r\n    }\r\n\r\n    // console.log(asPath)\r\n    \r\n    // const queryArr = asPath.split('?')[1].split('&');\r\n    // console.log(queryArr)\r\n    // const queryObj = queryArr.reduce((obj, entry) => {\r\n    //     const entryArr = entry.split('=');\r\n    //     obj[entryArr[0]] = encodeURIComponent(entryArr[1]); //C++ -> C%2B%2B\r\n    //     return obj; \r\n    // }, {});\r\n    // console.log(queryObj)\r\n    // const { q, lang, sort, order, page, per_page} = queryObj;\r\n    // ?q=react+language:javascript&sort=stars&order=desc&page=2\r\n    let queryString = `?q=${q}`;\r\n    lang && (queryString += `+language:${lang}`);\r\n    sort && (queryString += `&sort=${sort}&order=${order || 'desc'}`);\r\n    page && (queryString += `&page=${page}`);\r\n    queryString += `&per_page=${per_page}`;\r\n    \r\n    const result = await api.request({ \r\n        url: `/search/repositories${queryString}` \r\n    }, req, res);\r\n\r\n    return {\r\n        repos: result.data || data.react_repos\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}