{"ast":null,"code":"import _Button from \"antd/lib/button\";\nimport _Tabs from \"antd/lib/tabs\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useSelector } from 'react-redux';\nimport { useState, useEffect } from 'react';\nimport Repo from '../components/Repo';\nimport config from '../config';\nimport LRU from 'lru-cache';\nimport Router, { useRouter } from 'next/router';\nconst {\n  OAUTH_URL\n} = config;\nconst {\n  TabPane\n} = _Tabs;\nconst cache = new LRU({\n  maxAge: 1000 * 60 * 30 //30min\n\n});\nconst isServer = false;\nexport default function Index() {\n  const user = useSelector(state => state.user);\n  const initLoggedIn = user && user.id;\n  const {\n    0: userRepos,\n    1: setUserRepos\n  } = useState([]);\n  const {\n    0: userStarredRepos,\n    1: setUserStarredRepos\n  } = useState([]);\n  const {\n    0: loggedIn,\n    1: setLoggedIn\n  } = useState(initLoggedIn);\n  const router = useRouter();\n  const activeTabKey = router.query.key || 'repos';\n\n  const handleTabChange = activeTabKey => {\n    Router.push(`/?key=${activeTabKey}`);\n  };\n\n  useEffect(() => {\n    if (loggedIn) {\n      if (cache.get('userRepos') && cache.get('userStarredRepos')) {\n        return;\n      }\n\n      (async () => {\n        const userRepos = await api.request({\n          url: '/user/repos'\n        });\n        const userStarredRepos = await api.request({\n          url: '/user/starred'\n        });\n        setUserRepos(userRepos.data);\n        setUserStarredRepos(userStarredRepos.data);\n      })();\n    }\n  }, [loggedIn]);\n  useEffect(() => {\n    if (!isServer) {\n      //服务端环境不使用缓存\n      userRepos && cache.set('userRepos', userRepos);\n      userStarredRepos && cache.set('userStarredRepos', userStarredRepos);\n    }\n  }, [userRepos, userStarredRepos]);\n\n  const BeforeLogin = () => __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"jsx-449660228\" + \" \" + \"root\"\n  }, __jsx(_Button, {\n    href: OAUTH_URL,\n    onClick: () => setLoggedIn(true)\n  }, \"\\u672A\\u767B\\u5F55\\uFF0C\\u8BF7\\u70B9\\u51FB\\u767B\\u5F55\")), __jsx(_JSXStyle, {\n    id: \"449660228\"\n  }, \".root.jsx-449660228{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6XFznvJbnqItcXOmhueebrlxcbmV4dOmhueebrlxcbmV4dC1naXRodWJcXHBhZ2VzXFxpbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFnRWUsQUFHbUIsMEVBQ1UsbUdBQ0osNkZBQ3BCIiwiZmlsZSI6IkQ6XFznvJbnqItcXOmhueebrlxcbmV4dOmhueebrlxcbmV4dC1naXRodWJcXHBhZ2VzXFxpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVNlbGVjdG9yIH0gZnJvbSAncmVhY3QtcmVkdXgnXHJcbmltcG9ydCB7IEJ1dHRvbiwgVGFicyB9IGZyb20gJ2FudGQnXHJcbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCdcclxuaW1wb3J0IFJlcG8gZnJvbSAnLi4vY29tcG9uZW50cy9SZXBvJ1xyXG5pbXBvcnQgY29uZmlnIGZyb20gJy4uL2NvbmZpZydcclxuaW1wb3J0IExSVSBmcm9tICdscnUtY2FjaGUnXHJcbmltcG9ydCAgUm91dGVyLCB7IHVzZVJvdXRlciB9IGZyb20gJ25leHQvcm91dGVyJ1xyXG5cclxuY29uc3QgeyBPQVVUSF9VUkwgfSA9IGNvbmZpZztcclxuY29uc3QgeyBUYWJQYW5lIH0gPSBUYWJzO1xyXG5jb25zdCBjYWNoZSA9IG5ldyBMUlUoe1xyXG4gICAgbWF4QWdlOiAxMDAwICogNjAgKiAzMCAvLzMwbWluXHJcbn0pXHJcbmNvbnN0IGlzU2VydmVyID0gdHlwZW9mIHdpbmRvdyA9PT0gdW5kZWZpbmVkXHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBJbmRleCgpIHtcclxuICAgIGNvbnN0IHVzZXIgPSB1c2VTZWxlY3RvcihzdGF0ZSA9PiBzdGF0ZS51c2VyKTtcclxuICAgIGNvbnN0IGluaXRMb2dnZWRJbiA9IHVzZXIgJiYgdXNlci5pZDtcclxuICAgIGNvbnN0IFt1c2VyUmVwb3MsIHNldFVzZXJSZXBvc10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgICBjb25zdCBbdXNlclN0YXJyZWRSZXBvcywgc2V0VXNlclN0YXJyZWRSZXBvc10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgICBjb25zdCBbbG9nZ2VkSW4sIHNldExvZ2dlZEluXSA9IHVzZVN0YXRlKGluaXRMb2dnZWRJbik7XHJcbiAgICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTtcclxuICAgIGNvbnN0IGFjdGl2ZVRhYktleSA9IHJvdXRlci5xdWVyeS5rZXkgfHwgJ3JlcG9zJztcclxuXHJcbiAgICBjb25zdCBoYW5kbGVUYWJDaGFuZ2UgPSAoYWN0aXZlVGFiS2V5KSA9PiB7XHJcbiAgICAgICAgUm91dGVyLnB1c2goYC8/a2V5PSR7YWN0aXZlVGFiS2V5fWApXHJcbiAgICB9XHJcblxyXG5cdHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICAgICAgaWYgKGxvZ2dlZEluKSB7IFxyXG4gICAgICAgICAgICBpZiAoY2FjaGUuZ2V0KCd1c2VyUmVwb3MnKSAmJiBjYWNoZS5nZXQoJ3VzZXJTdGFycmVkUmVwb3MnKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB1c2VyUmVwb3MgPSBhd2FpdCBhcGkucmVxdWVzdChcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy91c2VyL3JlcG9zJ1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIFxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgY29uc3QgdXNlclN0YXJyZWRSZXBvcyA9IGF3YWl0IGFwaS5yZXF1ZXN0KFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3VzZXIvc3RhcnJlZCdcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICBzZXRVc2VyUmVwb3ModXNlclJlcG9zLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgc2V0VXNlclN0YXJyZWRSZXBvcyh1c2VyU3RhcnJlZFJlcG9zLmRhdGEpXHJcbiAgICAgICAgICAgIH0pKClcclxuICAgICAgICB9XHJcbiAgICB9LCBbbG9nZ2VkSW5dKVxyXG4gICAgXHJcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgICAgIGlmICghaXNTZXJ2ZXIpIHsgLy/mnI3liqHnq6/njq/looPkuI3kvb/nlKjnvJPlrZhcclxuICAgICAgICAgICAgdXNlclJlcG9zICYmIGNhY2hlLnNldCgndXNlclJlcG9zJywgdXNlclJlcG9zKVxyXG4gICAgICAgICAgICB1c2VyU3RhcnJlZFJlcG9zICYmICBjYWNoZS5zZXQoJ3VzZXJTdGFycmVkUmVwb3MnLCB1c2VyU3RhcnJlZFJlcG9zKVxyXG4gICAgICAgIH1cclxuICAgIH0sIFt1c2VyUmVwb3MsIHVzZXJTdGFycmVkUmVwb3NdKVxyXG5cclxuXHRjb25zdCBCZWZvcmVMb2dpbiA9ICgpID0+IChcclxuXHRcdDw+XHJcblx0XHRcdDxkaXYgY2xhc3NOYW1lPVwicm9vdFwiPlxyXG5cdFx0XHRcdDxCdXR0b24gaHJlZj17T0FVVEhfVVJMfSBvbkNsaWNrPXsoKSA9PiBzZXRMb2dnZWRJbih0cnVlKX0+XHJcbiAgICAgICAgICAgICAgICAgICAg5pyq55m75b2V77yM6K+354K55Ye755m75b2VXHJcbiAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuXHRcdFx0PC9kaXY+XHJcblx0XHRcdDxzdHlsZSBqc3g+e2BcclxuXHRcdFx0XHQucm9vdCB7XHJcblx0XHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xyXG5cdFx0XHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcblx0XHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0YH08L3N0eWxlPlxyXG5cdFx0PC8+XHJcblx0KVxyXG5cdFxyXG5cdGlmICghbG9nZ2VkSW4pIHtcclxuXHRcdHJldHVybiA8QmVmb3JlTG9naW4gLz5cclxuXHR9XHJcblxyXG5cdHJldHVybiAoXHJcblx0XHQ8PlxyXG5cdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cInJvb3RcIj5cclxuXHRcdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cInVzZXItaW5mb1wiPlxyXG5cdFx0XHRcdFx0PGltZyBzcmM9e3VzZXIuYXZhdGFyX3VybH0gYWx0PVwidXNlciBhdmF0YXJcIiBjbGFzc05hbWU9XCJ1c2VyLWF2YXRhclwiLz5cclxuXHRcdFx0XHRcdDxwIGNsYXNzTmFtZT1cInVzZXItbmFtZVwiPnt1c2VyLmxvZ2lufTwvcD5cclxuXHRcdFx0XHQ8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxUYWJzIGFjdGl2ZUtleT17YWN0aXZlVGFiS2V5fSBvbkNoYW5nZT17aGFuZGxlVGFiQ2hhbmdlfT5cclxuICAgICAgICAgICAgICAgICAgICA8VGFiUGFuZSBrZXk9XCJyZXBvc1wiIHRhYj1cIlJlcG9zaXRvcmllc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7LyogPGRpdiBjbGFzc05hbWU9XCJ1c2VyLXJlcG9zXCI+ICovfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3VzZXJSZXBvcy5tYXAocmVwbyA9PiA8UmVwbyBrZXk9e3JlcG8uaWR9IHJlcG89e3JlcG99IC8+KX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgey8qIDwvZGl2PiAqL31cclxuICAgICAgICAgICAgICAgICAgICA8L1RhYlBhbmU+XHJcbiAgICAgICAgICAgICAgICAgICAgPFRhYlBhbmUga2V5PVwic3RhcnNcIiB0YWI9XCJTdGFyc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dXNlclN0YXJyZWRSZXBvcy5tYXAocmVwbyA9PiA8UmVwbyBrZXk9e3JlcG8uaWR9IHJlcG89e3JlcG99IC8+KX1cclxuICAgICAgICAgICAgICAgICAgICA8L1RhYlBhbmU+XHJcbiAgICAgICAgICAgICAgICA8L1RhYnM+XHJcblx0XHRcdDwvZGl2PlxyXG5cdFx0XHQ8c3R5bGUganN4PntgXHJcblx0XHRcdFx0LnJvb3Qge1xyXG5cdFx0XHRcdFx0ZGlzcGxheTogZmxleDtcclxuXHRcdFx0XHRcdGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1xyXG5cdFx0XHRcdFx0cGFkZGluZzogMjBweCAwO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQudXNlci1pbmZvIHtcclxuXHRcdFx0XHRcdHdpZHRoOiAyMDBweDtcclxuXHRcdFx0XHRcdG1hcmdpbi1yaWdodDogNDBweDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0LnVzZXItbmFtZSB7XHJcblx0XHRcdFx0XHRmb250LXNpemU6IDIwcHg7XHJcblx0XHRcdFx0XHRmb250LXdlaWdodDogMzAwO1xyXG5cdFx0XHRcdFx0bWFyZ2luLXRvcDogMTBweDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0LnVzZXItYXZhdGFyIHtcclxuXHRcdFx0XHRcdHdpZHRoOiAxMDAlO1xyXG5cdFx0XHRcdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0YH08L3N0eWxlPlxyXG5cdFx0PC8+XHJcblx0KVxyXG59XHJcblxyXG5jb25zdCBhcGkgPSByZXF1aXJlKCcuLi9saWIvYXBpJylcclxuLy/osIPnlKjvvJog5pyN5Yqh56uv5riy5p+TaW5kZXjml7YgL+WuouaIt+err+WvvOiIquWIsGluZGV45pe2XHJcbkluZGV4LmdldEluaXRpdGFsUHJvcHMgPSBhc3luYyAoeyBjdHgsIHJlZHV4U3RvcmUgfSkgPT4ge1xyXG4gICAgLy/mtY/op4jlmajnjq/looPvvJogYXhpb3MuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAnKVxyXG4gICAgLy9ub2Rl546v5aKD77yaIGF4aW9zLmdldCgnaHR0cDovL2xvY2FsaG9zdDo4MCcpXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhcGkucmVxdWVzdChcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHVybDogJy91c2VyL3JlcG9zJ1xyXG4gICAgICAgIH0sIFxyXG4gICAgICAgIGN0eC5yZXEsIFxyXG4gICAgICAgIGN0eC5yZXNcclxuICAgIClcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGRhdGE6IHJlc3VsdC5kYXRhXHJcbiAgICB9XHJcbn1cclxuXHJcbiJdfQ== */\\n/*@ sourceURL=D:\\\\\\\\\\u7F16\\u7A0B\\\\\\\\\\u9879\\u76EE\\\\\\\\next\\u9879\\u76EE\\\\\\\\next-github\\\\\\\\pages\\\\\\\\index.js */\"));\n\n  if (!loggedIn) {\n    return __jsx(BeforeLogin, null);\n  }\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"jsx-1042228906\" + \" \" + \"root\"\n  }, __jsx(\"div\", {\n    className: \"jsx-1042228906\" + \" \" + \"user-info\"\n  }, __jsx(\"img\", {\n    src: user.avatar_url,\n    alt: \"user avatar\",\n    className: \"jsx-1042228906\" + \" \" + \"user-avatar\"\n  }), __jsx(\"p\", {\n    className: \"jsx-1042228906\" + \" \" + \"user-name\"\n  }, user.login)), __jsx(_Tabs, {\n    activeKey: activeTabKey,\n    onChange: handleTabChange\n  }, __jsx(TabPane, {\n    key: \"repos\",\n    tab: \"Repositories\"\n  }, userRepos.map(repo => __jsx(Repo, {\n    key: repo.id,\n    repo: repo\n  }))), __jsx(TabPane, {\n    key: \"stars\",\n    tab: \"Stars\"\n  }, userStarredRepos.map(repo => __jsx(Repo, {\n    key: repo.id,\n    repo: repo\n  }))))), __jsx(_JSXStyle, {\n    id: \"1042228906\"\n  }, \".root.jsx-1042228906{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;padding:20px 0;}.user-info.jsx-1042228906{width:200px;margin-right:40px;}.user-name.jsx-1042228906{font-size:20px;font-weight:300;margin-top:10px;}.user-avatar.jsx-1042228906{width:100%;border-radius:4px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6XFznvJbnqItcXOmhueebrlxcbmV4dOmhueebrlxcbmV4dC1naXRodWJcXHBhZ2VzXFxpbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFnR2UsQUFHbUIsQUFLRCxBQUlHLEFBS0osV0FDTyxDQVRBLEdBSUYsY0FNakIsQ0FUQSxDQUlpQixnQkFDakIsMkJBWHdCLDZHQUNSLGVBQ2hCIiwiZmlsZSI6IkQ6XFznvJbnqItcXOmhueebrlxcbmV4dOmhueebrlxcbmV4dC1naXRodWJcXHBhZ2VzXFxpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVNlbGVjdG9yIH0gZnJvbSAncmVhY3QtcmVkdXgnXHJcbmltcG9ydCB7IEJ1dHRvbiwgVGFicyB9IGZyb20gJ2FudGQnXHJcbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCdcclxuaW1wb3J0IFJlcG8gZnJvbSAnLi4vY29tcG9uZW50cy9SZXBvJ1xyXG5pbXBvcnQgY29uZmlnIGZyb20gJy4uL2NvbmZpZydcclxuaW1wb3J0IExSVSBmcm9tICdscnUtY2FjaGUnXHJcbmltcG9ydCAgUm91dGVyLCB7IHVzZVJvdXRlciB9IGZyb20gJ25leHQvcm91dGVyJ1xyXG5cclxuY29uc3QgeyBPQVVUSF9VUkwgfSA9IGNvbmZpZztcclxuY29uc3QgeyBUYWJQYW5lIH0gPSBUYWJzO1xyXG5jb25zdCBjYWNoZSA9IG5ldyBMUlUoe1xyXG4gICAgbWF4QWdlOiAxMDAwICogNjAgKiAzMCAvLzMwbWluXHJcbn0pXHJcbmNvbnN0IGlzU2VydmVyID0gdHlwZW9mIHdpbmRvdyA9PT0gdW5kZWZpbmVkXHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBJbmRleCgpIHtcclxuICAgIGNvbnN0IHVzZXIgPSB1c2VTZWxlY3RvcihzdGF0ZSA9PiBzdGF0ZS51c2VyKTtcclxuICAgIGNvbnN0IGluaXRMb2dnZWRJbiA9IHVzZXIgJiYgdXNlci5pZDtcclxuICAgIGNvbnN0IFt1c2VyUmVwb3MsIHNldFVzZXJSZXBvc10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgICBjb25zdCBbdXNlclN0YXJyZWRSZXBvcywgc2V0VXNlclN0YXJyZWRSZXBvc10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgICBjb25zdCBbbG9nZ2VkSW4sIHNldExvZ2dlZEluXSA9IHVzZVN0YXRlKGluaXRMb2dnZWRJbik7XHJcbiAgICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTtcclxuICAgIGNvbnN0IGFjdGl2ZVRhYktleSA9IHJvdXRlci5xdWVyeS5rZXkgfHwgJ3JlcG9zJztcclxuXHJcbiAgICBjb25zdCBoYW5kbGVUYWJDaGFuZ2UgPSAoYWN0aXZlVGFiS2V5KSA9PiB7XHJcbiAgICAgICAgUm91dGVyLnB1c2goYC8/a2V5PSR7YWN0aXZlVGFiS2V5fWApXHJcbiAgICB9XHJcblxyXG5cdHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICAgICAgaWYgKGxvZ2dlZEluKSB7IFxyXG4gICAgICAgICAgICBpZiAoY2FjaGUuZ2V0KCd1c2VyUmVwb3MnKSAmJiBjYWNoZS5nZXQoJ3VzZXJTdGFycmVkUmVwb3MnKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB1c2VyUmVwb3MgPSBhd2FpdCBhcGkucmVxdWVzdChcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy91c2VyL3JlcG9zJ1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIFxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgY29uc3QgdXNlclN0YXJyZWRSZXBvcyA9IGF3YWl0IGFwaS5yZXF1ZXN0KFxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3VzZXIvc3RhcnJlZCdcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICBzZXRVc2VyUmVwb3ModXNlclJlcG9zLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgc2V0VXNlclN0YXJyZWRSZXBvcyh1c2VyU3RhcnJlZFJlcG9zLmRhdGEpXHJcbiAgICAgICAgICAgIH0pKClcclxuICAgICAgICB9XHJcbiAgICB9LCBbbG9nZ2VkSW5dKVxyXG4gICAgXHJcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgICAgIGlmICghaXNTZXJ2ZXIpIHsgLy/mnI3liqHnq6/njq/looPkuI3kvb/nlKjnvJPlrZhcclxuICAgICAgICAgICAgdXNlclJlcG9zICYmIGNhY2hlLnNldCgndXNlclJlcG9zJywgdXNlclJlcG9zKVxyXG4gICAgICAgICAgICB1c2VyU3RhcnJlZFJlcG9zICYmICBjYWNoZS5zZXQoJ3VzZXJTdGFycmVkUmVwb3MnLCB1c2VyU3RhcnJlZFJlcG9zKVxyXG4gICAgICAgIH1cclxuICAgIH0sIFt1c2VyUmVwb3MsIHVzZXJTdGFycmVkUmVwb3NdKVxyXG5cclxuXHRjb25zdCBCZWZvcmVMb2dpbiA9ICgpID0+IChcclxuXHRcdDw+XHJcblx0XHRcdDxkaXYgY2xhc3NOYW1lPVwicm9vdFwiPlxyXG5cdFx0XHRcdDxCdXR0b24gaHJlZj17T0FVVEhfVVJMfSBvbkNsaWNrPXsoKSA9PiBzZXRMb2dnZWRJbih0cnVlKX0+XHJcbiAgICAgICAgICAgICAgICAgICAg5pyq55m75b2V77yM6K+354K55Ye755m75b2VXHJcbiAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuXHRcdFx0PC9kaXY+XHJcblx0XHRcdDxzdHlsZSBqc3g+e2BcclxuXHRcdFx0XHQucm9vdCB7XHJcblx0XHRcdFx0XHRkaXNwbGF5OiBmbGV4O1xyXG5cdFx0XHRcdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcblx0XHRcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0YH08L3N0eWxlPlxyXG5cdFx0PC8+XHJcblx0KVxyXG5cdFxyXG5cdGlmICghbG9nZ2VkSW4pIHtcclxuXHRcdHJldHVybiA8QmVmb3JlTG9naW4gLz5cclxuXHR9XHJcblxyXG5cdHJldHVybiAoXHJcblx0XHQ8PlxyXG5cdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cInJvb3RcIj5cclxuXHRcdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cInVzZXItaW5mb1wiPlxyXG5cdFx0XHRcdFx0PGltZyBzcmM9e3VzZXIuYXZhdGFyX3VybH0gYWx0PVwidXNlciBhdmF0YXJcIiBjbGFzc05hbWU9XCJ1c2VyLWF2YXRhclwiLz5cclxuXHRcdFx0XHRcdDxwIGNsYXNzTmFtZT1cInVzZXItbmFtZVwiPnt1c2VyLmxvZ2lufTwvcD5cclxuXHRcdFx0XHQ8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxUYWJzIGFjdGl2ZUtleT17YWN0aXZlVGFiS2V5fSBvbkNoYW5nZT17aGFuZGxlVGFiQ2hhbmdlfT5cclxuICAgICAgICAgICAgICAgICAgICA8VGFiUGFuZSBrZXk9XCJyZXBvc1wiIHRhYj1cIlJlcG9zaXRvcmllc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7LyogPGRpdiBjbGFzc05hbWU9XCJ1c2VyLXJlcG9zXCI+ICovfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3VzZXJSZXBvcy5tYXAocmVwbyA9PiA8UmVwbyBrZXk9e3JlcG8uaWR9IHJlcG89e3JlcG99IC8+KX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgey8qIDwvZGl2PiAqL31cclxuICAgICAgICAgICAgICAgICAgICA8L1RhYlBhbmU+XHJcbiAgICAgICAgICAgICAgICAgICAgPFRhYlBhbmUga2V5PVwic3RhcnNcIiB0YWI9XCJTdGFyc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7dXNlclN0YXJyZWRSZXBvcy5tYXAocmVwbyA9PiA8UmVwbyBrZXk9e3JlcG8uaWR9IHJlcG89e3JlcG99IC8+KX1cclxuICAgICAgICAgICAgICAgICAgICA8L1RhYlBhbmU+XHJcbiAgICAgICAgICAgICAgICA8L1RhYnM+XHJcblx0XHRcdDwvZGl2PlxyXG5cdFx0XHQ8c3R5bGUganN4PntgXHJcblx0XHRcdFx0LnJvb3Qge1xyXG5cdFx0XHRcdFx0ZGlzcGxheTogZmxleDtcclxuXHRcdFx0XHRcdGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1xyXG5cdFx0XHRcdFx0cGFkZGluZzogMjBweCAwO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQudXNlci1pbmZvIHtcclxuXHRcdFx0XHRcdHdpZHRoOiAyMDBweDtcclxuXHRcdFx0XHRcdG1hcmdpbi1yaWdodDogNDBweDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0LnVzZXItbmFtZSB7XHJcblx0XHRcdFx0XHRmb250LXNpemU6IDIwcHg7XHJcblx0XHRcdFx0XHRmb250LXdlaWdodDogMzAwO1xyXG5cdFx0XHRcdFx0bWFyZ2luLXRvcDogMTBweDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0LnVzZXItYXZhdGFyIHtcclxuXHRcdFx0XHRcdHdpZHRoOiAxMDAlO1xyXG5cdFx0XHRcdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0YH08L3N0eWxlPlxyXG5cdFx0PC8+XHJcblx0KVxyXG59XHJcblxyXG5jb25zdCBhcGkgPSByZXF1aXJlKCcuLi9saWIvYXBpJylcclxuLy/osIPnlKjvvJog5pyN5Yqh56uv5riy5p+TaW5kZXjml7YgL+WuouaIt+err+WvvOiIquWIsGluZGV45pe2XHJcbkluZGV4LmdldEluaXRpdGFsUHJvcHMgPSBhc3luYyAoeyBjdHgsIHJlZHV4U3RvcmUgfSkgPT4ge1xyXG4gICAgLy/mtY/op4jlmajnjq/looPvvJogYXhpb3MuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAnKVxyXG4gICAgLy9ub2Rl546v5aKD77yaIGF4aW9zLmdldCgnaHR0cDovL2xvY2FsaG9zdDo4MCcpXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhcGkucmVxdWVzdChcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHVybDogJy91c2VyL3JlcG9zJ1xyXG4gICAgICAgIH0sIFxyXG4gICAgICAgIGN0eC5yZXEsIFxyXG4gICAgICAgIGN0eC5yZXNcclxuICAgIClcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGRhdGE6IHJlc3VsdC5kYXRhXHJcbiAgICB9XHJcbn1cclxuXHJcbiJdfQ== */\\n/*@ sourceURL=D:\\\\\\\\\\u7F16\\u7A0B\\\\\\\\\\u9879\\u76EE\\\\\\\\next\\u9879\\u76EE\\\\\\\\next-github\\\\\\\\pages\\\\\\\\index.js */\"));\n}\n\nconst api = require('../lib/api'); //调用： 服务端渲染index时 /客户端导航到index时\n\n\nIndex.getInititalProps = async ({\n  ctx,\n  reduxStore\n}) => {\n  //浏览器环境： axios.get('http://localhost:3000')\n  //node环境： axios.get('http://localhost:80')\n  const result = await api.request({\n    url: '/user/repos'\n  }, ctx.req, ctx.res);\n  return {\n    data: result.data\n  };\n};","map":{"version":3,"sources":["D:/编程/项目/next项目/next-github/pages/index.js"],"names":["useSelector","useState","useEffect","Repo","config","LRU","Router","useRouter","OAUTH_URL","TabPane","cache","maxAge","isServer","Index","user","state","initLoggedIn","id","userRepos","setUserRepos","userStarredRepos","setUserStarredRepos","loggedIn","setLoggedIn","router","activeTabKey","query","key","handleTabChange","push","get","api","request","url","data","set","BeforeLogin","avatar_url","login","map","repo","require","getInititalProps","ctx","reduxStore","result","req","res"],"mappings":"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","sourcesContent":["import { useSelector } from 'react-redux'\r\nimport { Button, Tabs } from 'antd'\r\nimport { useState, useEffect } from 'react'\r\nimport Repo from '../components/Repo'\r\nimport config from '../config'\r\nimport LRU from 'lru-cache'\r\nimport  Router, { useRouter } from 'next/router'\r\n\r\nconst { OAUTH_URL } = config;\r\nconst { TabPane } = Tabs;\r\nconst cache = new LRU({\r\n    maxAge: 1000 * 60 * 30 //30min\r\n})\r\nconst isServer = typeof window === undefined\r\n\r\nexport default function Index() {\r\n    const user = useSelector(state => state.user);\r\n    const initLoggedIn = user && user.id;\r\n    const [userRepos, setUserRepos] = useState([]);\r\n    const [userStarredRepos, setUserStarredRepos] = useState([]);\r\n    const [loggedIn, setLoggedIn] = useState(initLoggedIn);\r\n    const router = useRouter();\r\n    const activeTabKey = router.query.key || 'repos';\r\n\r\n    const handleTabChange = (activeTabKey) => {\r\n        Router.push(`/?key=${activeTabKey}`)\r\n    }\r\n\r\n\tuseEffect(() => {\r\n        if (loggedIn) { \r\n            if (cache.get('userRepos') && cache.get('userStarredRepos')) {\r\n                return;\r\n            }\r\n            (async () => {\r\n                const userRepos = await api.request(\r\n                    {\r\n                        url: '/user/repos'\r\n                    }, \r\n                )\r\n                const userStarredRepos = await api.request(\r\n                    {\r\n                        url: '/user/starred'\r\n                    }\r\n                )\r\n                setUserRepos(userRepos.data);\r\n                setUserStarredRepos(userStarredRepos.data)\r\n            })()\r\n        }\r\n    }, [loggedIn])\r\n    \r\n    useEffect(() => {\r\n        if (!isServer) { //服务端环境不使用缓存\r\n            userRepos && cache.set('userRepos', userRepos)\r\n            userStarredRepos &&  cache.set('userStarredRepos', userStarredRepos)\r\n        }\r\n    }, [userRepos, userStarredRepos])\r\n\r\n\tconst BeforeLogin = () => (\r\n\t\t<>\r\n\t\t\t<div className=\"root\">\r\n\t\t\t\t<Button href={OAUTH_URL} onClick={() => setLoggedIn(true)}>\r\n                    未登录，请点击登录\r\n                </Button>\r\n\t\t\t</div>\r\n\t\t\t<style jsx>{`\r\n\t\t\t\t.root {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t}\r\n\t\t\t`}</style>\r\n\t\t</>\r\n\t)\r\n\t\r\n\tif (!loggedIn) {\r\n\t\treturn <BeforeLogin />\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div className=\"root\">\r\n\t\t\t\t<div className=\"user-info\">\r\n\t\t\t\t\t<img src={user.avatar_url} alt=\"user avatar\" className=\"user-avatar\"/>\r\n\t\t\t\t\t<p className=\"user-name\">{user.login}</p>\r\n\t\t\t\t</div>\r\n                <Tabs activeKey={activeTabKey} onChange={handleTabChange}>\r\n                    <TabPane key=\"repos\" tab=\"Repositories\">\r\n                        {/* <div className=\"user-repos\"> */}\r\n                            {userRepos.map(repo => <Repo key={repo.id} repo={repo} />)}\r\n                        {/* </div> */}\r\n                    </TabPane>\r\n                    <TabPane key=\"stars\" tab=\"Stars\">\r\n                        {userStarredRepos.map(repo => <Repo key={repo.id} repo={repo} />)}\r\n                    </TabPane>\r\n                </Tabs>\r\n\t\t\t</div>\r\n\t\t\t<style jsx>{`\r\n\t\t\t\t.root {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: flex-start;\r\n\t\t\t\t\tpadding: 20px 0;\r\n\t\t\t\t}\r\n\t\t\t\t.user-info {\r\n\t\t\t\t\twidth: 200px;\r\n\t\t\t\t\tmargin-right: 40px;\r\n\t\t\t\t}\r\n\t\t\t\t.user-name {\r\n\t\t\t\t\tfont-size: 20px;\r\n\t\t\t\t\tfont-weight: 300;\r\n\t\t\t\t\tmargin-top: 10px;\r\n\t\t\t\t}\r\n\t\t\t\t.user-avatar {\r\n\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\tborder-radius: 4px;\r\n\t\t\t\t}\r\n\t\t\t`}</style>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nconst api = require('../lib/api')\r\n//调用： 服务端渲染index时 /客户端导航到index时\r\nIndex.getInititalProps = async ({ ctx, reduxStore }) => {\r\n    //浏览器环境： axios.get('http://localhost:3000')\r\n    //node环境： axios.get('http://localhost:80')\r\n    const result = await api.request(\r\n        {\r\n            url: '/user/repos'\r\n        }, \r\n        ctx.req, \r\n        ctx.res\r\n    )\r\n\r\n    return {\r\n        data: result.data\r\n    }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}