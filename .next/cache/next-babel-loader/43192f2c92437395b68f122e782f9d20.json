{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport Link from 'next/link';\nimport Repo from './Repo';\nimport api from '../lib/api';\nimport { useRouter } from 'next/router';\nimport { getCache, setCache } from './repo-basic-cache';\nimport { useEffect } from 'react';\nconst isServer = true;\n\nfunction makeQueryStr(queryObj) {\n  const query = Object.entries(queryObj).reduce((result, entry) => {\n    result.push(entry.join('='));\n    return result;\n  }, []).join('&');\n  return `?${query}`;\n}\n\nexport default (Comp => {\n  function WithDetail(_ref) {\n    let {\n      repoBasic\n    } = _ref,\n        rest = _objectWithoutProperties(_ref, [\"repoBasic\"]);\n\n    console.log('rest: ' + rest);\n    const router = useRouter();\n    const queryStr = makeQueryStr(router.query);\n    useEffect(() => {\n      if (!isServer) {\n        setCache(repoBasic);\n      }\n    });\n    return __jsx(\"div\", {\n      className: \"jsx-3172102186\" + \" \" + \"root\"\n    }, __jsx(\"div\", {\n      className: \"jsx-3172102186\" + \" \" + \"repo-basic\"\n    }, __jsx(Repo, {\n      repo: repoBasic\n    }), __jsx(\"div\", {\n      className: \"jsx-3172102186\" + \" \" + \"tabs\"\n    }, __jsx(Link, {\n      href: `/detail${queryStr}`\n    }, __jsx(\"a\", {\n      className: \"jsx-3172102186\" + \" \" + \"tab index\"\n    }, \"Readme\")), __jsx(Link, {\n      href: `/detail/issues${queryStr}`\n    }, __jsx(\"a\", {\n      className: \"jsx-3172102186\" + \" \" + \"tab issues\"\n    }, \"Issues\")))), __jsx(\"div\", {\n      className: \"jsx-3172102186\"\n    }, __jsx(Comp, rest)), __jsx(_JSXStyle, {\n      id: \"3172102186\"\n    }, \".root.jsx-3172102186{padding-top:20px;}.repo-basic.jsx-3172102186{border:1px solid #ddd;border-radius:5px;margin-bottom:20px;}.tabs.jsx-3172102186{padding:20px;}.tab.jsx-3172102186{margin-right:20px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6XFznvJbnqItcXOmhueebrlxcbmV4dOmhueebrlxcbmV4dC1naXRodWJcXGNvbXBvbmVudHNcXHdpdGgtcmVwby1iYXNpYy5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBOEM0QixBQUcwQyxBQUdLLEFBS1QsQUFHSyxhQUZ0QixJQVJBLENBV0EsSUFSc0Isa0JBQ0MsbUJBQ3ZCIiwiZmlsZSI6IkQ6XFznvJbnqItcXOmhueebrlxcbmV4dOmhueebrlxcbmV4dC1naXRodWJcXGNvbXBvbmVudHNcXHdpdGgtcmVwby1iYXNpYy5qc3giLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTGluayBmcm9tICduZXh0L2xpbmsnXHJcbmltcG9ydCBSZXBvIGZyb20gJy4vUmVwbydcclxuaW1wb3J0IGFwaSBmcm9tICcuLi9saWIvYXBpJ1xyXG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcidcclxuaW1wb3J0IHsgZ2V0Q2FjaGUsIHNldENhY2hlIH0gZnJvbSAnLi9yZXBvLWJhc2ljLWNhY2hlJ1xyXG5pbXBvcnQgeyB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCdcclxuXHJcbmNvbnN0IGlzU2VydmVyID0gdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCc7XHJcblxyXG5mdW5jdGlvbiBtYWtlUXVlcnlTdHIocXVlcnlPYmopIHtcclxuICAgIGNvbnN0IHF1ZXJ5ID0gT2JqZWN0LmVudHJpZXMocXVlcnlPYmopXHJcbiAgICAgICAgLnJlZHVjZSgocmVzdWx0LCBlbnRyeSkgPT4ge1xyXG4gICAgICAgICAgICByZXN1bHQucHVzaChlbnRyeS5qb2luKCc9JykpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgICAgfSwgW10pLmpvaW4oJyYnKVxyXG4gICAgICAgIHJldHVybiBgPyR7cXVlcnl9YFxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCAoQ29tcCkgPT4ge1xyXG4gICAgZnVuY3Rpb24gV2l0aERldGFpbCh7IHJlcG9CYXNpYywgLi4ucmVzdCB9KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ3Jlc3Q6ICcgKyByZXN0KVxyXG4gICAgICAgIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpO1xyXG4gICAgICAgIGNvbnN0IHF1ZXJ5U3RyID0gbWFrZVF1ZXJ5U3RyKHJvdXRlci5xdWVyeSk7XHJcblxyXG4gICAgICAgIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghaXNTZXJ2ZXIpIHtcclxuICAgICAgICAgICAgICAgIHNldENhY2hlKHJlcG9CYXNpYyk7XHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyb290XCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJlcG8tYmFzaWNcIj5cclxuICAgICAgICAgICAgICAgICAgICA8UmVwbyByZXBvPXtyZXBvQmFzaWN9Lz5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhYnNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPExpbmsgaHJlZj17YC9kZXRhaWwke3F1ZXJ5U3RyfWB9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwidGFiIGluZGV4XCI+UmVhZG1lPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L0xpbms+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rIGhyZWY9e2AvZGV0YWlsL2lzc3VlcyR7cXVlcnlTdHJ9YH0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJ0YWIgaXNzdWVzXCI+SXNzdWVzPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L0xpbms+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPENvbXAgey4uLnJlc3R9IC8+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxzdHlsZSBqc3g+e2BcclxuICAgICAgICAgICAgICAgICAgICAucm9vdCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmctdG9wOiAyMHB4O1xyXG4gICAgICAgICAgICAgICAgICAgIH0gICAgXHJcbiAgICAgICAgICAgICAgICAgICAgLnJlcG8tYmFzaWMge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjZGRkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1cHg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC50YWJzIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMjBweDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLnRhYiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbi1yaWdodDogMjBweDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBgfTwvc3R5bGU+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICBXaXRoRGV0YWlsLmdldEluaXRpYWxQcm9wcyA9IGFzeW5jIChjb250ZXh0KSA9PiB7XHJcbiAgICAgICAgY29uc3QgeyBxdWVyeSwgcmVxLCByZXN9ID0gY29udGV4dDtcclxuICAgICAgICBjb25zdCB7IG5hbWUsIG93bmVyIH0gPSBxdWVyeTtcclxuICAgICAgICBjb25zdCBmdWxsTmFtZSA9IGAke293bmVyfS8ke25hbWV9YDtcclxuXHJcbiAgICAgICAgbGV0IHBhZ2VEYXRhID0ge307XHJcbiAgICAgICAgaWYgKHR5cGVvZiBDb21wLmdldEluaXRpYWxQcm9wcyA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnaW4gaGVyZScpXHJcbiAgICAgICAgICAgIHBhZ2VEYXRhID0gQ29tcC5nZXRJbml0aWFsUHJvcHMoY29udGV4dCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZ2V0Q2FjaGUoZnVsbE5hbWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICByZXBvQmFzaWM6IGdldENhY2hlKGZ1bGxOYW1lKSxcclxuICAgICAgICAgICAgICAgIC4uLnBhZ2VEYXRhXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcmVwb0Jhc2ljUmVzcCA9IGF3YWl0IGFwaS5yZXF1ZXN0KHtcclxuICAgICAgICAgICAgdXJsOiBgL3JlcG9zLyR7b3duZXJ9LyR7bmFtZX1gXHJcbiAgICAgICAgfSwgcmVxLCByZXMpOyAgXHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlcG9CYXNpYzogcmVwb0Jhc2ljUmVzcC5kYXRhLFxyXG4gICAgICAgICAgICAuLi5wYWdlRGF0YVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIFdpdGhEZXRhaWxcclxufSJdfQ== */\\n/*@ sourceURL=D:\\\\\\\\\\u7F16\\u7A0B\\\\\\\\\\u9879\\u76EE\\\\\\\\next\\u9879\\u76EE\\\\\\\\next-github\\\\\\\\components\\\\\\\\with-repo-basic.jsx */\"));\n  }\n\n  WithDetail.getInitialProps = async context => {\n    const {\n      query,\n      req,\n      res\n    } = context;\n    const {\n      name,\n      owner\n    } = query;\n    const fullName = `${owner}/${name}`;\n    let pageData = {};\n\n    if (typeof Comp.getInitialProps === 'function') {\n      console.log('in here');\n      pageData = Comp.getInitialProps(context);\n    }\n\n    if (getCache(fullName)) {\n      return _objectSpread({\n        repoBasic: getCache(fullName)\n      }, pageData);\n    }\n\n    const repoBasicResp = await api.request({\n      url: `/repos/${owner}/${name}`\n    }, req, res);\n    return _objectSpread({\n      repoBasic: repoBasicResp.data\n    }, pageData);\n  };\n\n  return WithDetail;\n});","map":{"version":3,"sources":["D:/编程/项目/next项目/next-github/components/with-repo-basic.jsx"],"names":["Link","Repo","api","useRouter","getCache","setCache","useEffect","isServer","makeQueryStr","queryObj","query","Object","entries","reduce","result","entry","push","join","Comp","WithDetail","repoBasic","rest","console","log","router","queryStr","getInitialProps","context","req","res","name","owner","fullName","pageData","repoBasicResp","request","url","data"],"mappings":";;;;;;;;;;;;;;AAAA,OAAOA,IAAP,MAAiB,WAAjB;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,OAAOC,GAAP,MAAgB,YAAhB;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,SAASC,QAAT,EAAmBC,QAAnB,QAAmC,oBAAnC;AACA,SAASC,SAAT,QAA0B,OAA1B;AAEA,MAAMC,QAAQ,OAAd;;AAEA,SAASC,YAAT,CAAsBC,QAAtB,EAAgC;AAC5B,QAAMC,KAAK,GAAGC,MAAM,CAACC,OAAP,CAAeH,QAAf,EACTI,MADS,CACF,CAACC,MAAD,EAASC,KAAT,KAAmB;AACvBD,IAAAA,MAAM,CAACE,IAAP,CAAYD,KAAK,CAACE,IAAN,CAAW,GAAX,CAAZ;AACA,WAAOH,MAAP;AACH,GAJS,EAIP,EAJO,EAIHG,IAJG,CAIE,GAJF,CAAd;AAKI,SAAQ,IAAGP,KAAM,EAAjB;AACP;;AAED,gBAAgBQ,IAAD,IAAU;AACrB,WAASC,UAAT,OAA4C;AAAA,QAAxB;AAAEC,MAAAA;AAAF,KAAwB;AAAA,QAARC,IAAQ;;AACxCC,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAWF,IAAvB;AACA,UAAMG,MAAM,GAAGrB,SAAS,EAAxB;AACA,UAAMsB,QAAQ,GAAGjB,YAAY,CAACgB,MAAM,CAACd,KAAR,CAA7B;AAEAJ,IAAAA,SAAS,CAAC,MAAM;AACZ,UAAI,CAACC,QAAL,EAAe;AACXF,QAAAA,QAAQ,CAACe,SAAD,CAAR;AACH;AACJ,KAJQ,CAAT;AAMA,WACI;AAAA,0CAAe;AAAf,OACI;AAAA,0CAAe;AAAf,OACI,MAAC,IAAD;AAAM,MAAA,IAAI,EAAEA;AAAZ,MADJ,EAEI;AAAA,0CAAe;AAAf,OACI,MAAC,IAAD;AAAM,MAAA,IAAI,EAAG,UAASK,QAAS;AAA/B,OACI;AAAA,0CAAa;AAAb,gBADJ,CADJ,EAII,MAAC,IAAD;AAAM,MAAA,IAAI,EAAG,iBAAgBA,QAAS;AAAtC,OACI;AAAA,0CAAa;AAAb,gBADJ,CAJJ,CAFJ,CADJ,EAYI;AAAA;AAAA,OACI,MAAC,IAAD,EAAUJ,IAAV,CADJ,CAZJ;AAAA;AAAA,qzJADJ;AAkCH;;AAEDF,EAAAA,UAAU,CAACO,eAAX,GAA6B,MAAOC,OAAP,IAAmB;AAC5C,UAAM;AAAEjB,MAAAA,KAAF;AAASkB,MAAAA,GAAT;AAAcC,MAAAA;AAAd,QAAqBF,OAA3B;AACA,UAAM;AAAEG,MAAAA,IAAF;AAAQC,MAAAA;AAAR,QAAkBrB,KAAxB;AACA,UAAMsB,QAAQ,GAAI,GAAED,KAAM,IAAGD,IAAK,EAAlC;AAEA,QAAIG,QAAQ,GAAG,EAAf;;AACA,QAAI,OAAOf,IAAI,CAACQ,eAAZ,KAAgC,UAApC,EAAgD;AAC5CJ,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACAU,MAAAA,QAAQ,GAAGf,IAAI,CAACQ,eAAL,CAAqBC,OAArB,CAAX;AACH;;AAED,QAAIvB,QAAQ,CAAC4B,QAAD,CAAZ,EAAwB;AACpB;AACIZ,QAAAA,SAAS,EAAEhB,QAAQ,CAAC4B,QAAD;AADvB,SAEOC,QAFP;AAIH;;AACD,UAAMC,aAAa,GAAG,MAAMhC,GAAG,CAACiC,OAAJ,CAAY;AACpCC,MAAAA,GAAG,EAAG,UAASL,KAAM,IAAGD,IAAK;AADO,KAAZ,EAEzBF,GAFyB,EAEpBC,GAFoB,CAA5B;AAIA;AACIT,MAAAA,SAAS,EAAEc,aAAa,CAACG;AAD7B,OAEOJ,QAFP;AAIH,GAzBD;;AA2BA,SAAOd,UAAP;AACH,CA5ED","sourcesContent":["import Link from 'next/link'\r\nimport Repo from './Repo'\r\nimport api from '../lib/api'\r\nimport { useRouter } from 'next/router'\r\nimport { getCache, setCache } from './repo-basic-cache'\r\nimport { useEffect } from 'react'\r\n\r\nconst isServer = typeof window === 'undefined';\r\n\r\nfunction makeQueryStr(queryObj) {\r\n    const query = Object.entries(queryObj)\r\n        .reduce((result, entry) => {\r\n            result.push(entry.join('='));\r\n            return result\r\n        }, []).join('&')\r\n        return `?${query}`\r\n}\r\n\r\nexport default (Comp) => {\r\n    function WithDetail({ repoBasic, ...rest }) {\r\n        console.log('rest: ' + rest)\r\n        const router = useRouter();\r\n        const queryStr = makeQueryStr(router.query);\r\n\r\n        useEffect(() => {\r\n            if (!isServer) {\r\n                setCache(repoBasic);\r\n            } \r\n        })\r\n\r\n        return (\r\n            <div className=\"root\">\r\n                <div className=\"repo-basic\">\r\n                    <Repo repo={repoBasic}/>\r\n                    <div className=\"tabs\">\r\n                        <Link href={`/detail${queryStr}`}>\r\n                            <a className=\"tab index\">Readme</a>\r\n                        </Link>\r\n                        <Link href={`/detail/issues${queryStr}`}>\r\n                            <a className=\"tab issues\">Issues</a>\r\n                        </Link>\r\n                    </div>\r\n                </div>\r\n                <div>\r\n                    <Comp {...rest} />\r\n                </div>\r\n                <style jsx>{`\r\n                    .root {\r\n                        padding-top: 20px;\r\n                    }    \r\n                    .repo-basic {\r\n                        border: 1px solid #ddd;\r\n                        border-radius: 5px;\r\n                        margin-bottom: 20px;\r\n                    }\r\n                    .tabs {\r\n                        padding: 20px;\r\n                    }\r\n                    .tab {\r\n                        margin-right: 20px;\r\n                    }\r\n                `}</style>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    WithDetail.getInitialProps = async (context) => {\r\n        const { query, req, res} = context;\r\n        const { name, owner } = query;\r\n        const fullName = `${owner}/${name}`;\r\n\r\n        let pageData = {};\r\n        if (typeof Comp.getInitialProps === 'function') {\r\n            console.log('in here')\r\n            pageData = Comp.getInitialProps(context);\r\n        }\r\n\r\n        if (getCache(fullName)) {\r\n            return {\r\n                repoBasic: getCache(fullName),\r\n                ...pageData\r\n            }\r\n        }\r\n        const repoBasicResp = await api.request({\r\n            url: `/repos/${owner}/${name}`\r\n        }, req, res);  \r\n\r\n        return {\r\n            repoBasic: repoBasicResp.data,\r\n            ...pageData\r\n        };\r\n    }\r\n\r\n    return WithDetail\r\n}"]},"metadata":{},"sourceType":"module"}